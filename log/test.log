  [1m[36m (115.1ms)[0m  [1mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL) [0m
  [1m[35m (16.0ms)[0m  CREATE UNIQUE INDEX  "unique_schema_migrations" ON "schema_migrations"  ("version")
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Migrating to DeviseCreateUsers (20151217071629)
  [1m[35m (1.0ms)[0m  BEGIN
  [1m[36m (45.0ms)[0m  [1mCREATE TABLE "users" ("id" serial primary key, "email" character varying DEFAULT '' NOT NULL, "encrypted_password" character varying DEFAULT '' NOT NULL, "reset_password_token" character varying, "reset_password_sent_at" timestamp, "remember_created_at" timestamp, "sign_in_count" integer DEFAULT 0 NOT NULL, "current_sign_in_at" timestamp, "last_sign_in_at" timestamp, "current_sign_in_ip" inet, "last_sign_in_ip" inet, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (10.0ms)[0m  CREATE UNIQUE INDEX  "index_users_on_email" ON "users"  ("email")
  [1m[36m (17.0ms)[0m  [1mCREATE UNIQUE INDEX  "index_users_on_reset_password_token" ON "users"  ("reset_password_token")[0m
  [1m[35mSQL (5.0ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20151217071629"]]
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
Migrating to CreateCharities (20151217074751)
  [1m[35m (9.0ms)[0m  BEGIN
  [1m[36m (27.0ms)[0m  [1mCREATE TABLE "charities" ("id" serial primary key, "name" character varying, "total" integer, "currency" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20151217074751"]]
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
Migrating to AddDescriptionToCharities (20151218060353)
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (32.0ms)[0m  [1mALTER TABLE "charities" ADD "description" text DEFAULT ''[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20151218060353"]]
  [1m[36m (3.0ms)[0m  [1mCOMMIT[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.0ms)[0m  SELECT "schema_migrations".* FROM "schema_migrations"
  [1m[36m (3.0ms)[0m  [1mSELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'charities'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname
[0m
  [1m[35m (2.0ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'users'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[36mActiveRecord::SchemaMigration Load (11.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (4.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (4.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (3.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-04 09:50:46', '2016-01-04 09:50:46', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-04 09:50:46', '2016-01-04 09:50:46', 459292723)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-04 09:50:46', '2016-01-04 09:50:46', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-04 09:50:46', '2016-01-04 09:50:46', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-04 09:50:46', '2016-01-04 09:50:46', 83783397)[0m
  [1m[35mFixture Delete (3.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$iloNxJ9RXnmlzKCohf/MK.4fLQL5BiN/wWTfrB0SEqAKc8Itkd/1S', '2016-01-04 09:50:46', '2016-01-04 09:50:46', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (4.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:50:47.107287"], ["updated_at", "2016-01-04 09:50:47.107287"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:50:47.112288"], ["updated_at", "2016-01-04 09:50:47.112288"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:50:47.113289"], ["updated_at", "2016-01-04 09:50:47.113289"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:50:47.115290"], ["updated_at", "2016-01-04 09:50:47.115290"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:50:47.190318"], ["updated_at", "2016-01-04 09:50:47.190318"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:50:47.202322"], ["updated_at", "2016-01-04 09:50:47.202322"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:50:47.204323"], ["updated_at", "2016-01-04 09:50:47.204323"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:50:47.205323"], ["updated_at", "2016-01-04 09:50:47.205323"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:50:47.209326"], ["updated_at", "2016-01-04 09:50:47.209326"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 09:50:47.304360"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 09:50:47.310362"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 09:50:47.312363"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (17.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (3.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (2.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-04 09:54:15', '2016-01-04 09:54:15', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-04 09:54:15', '2016-01-04 09:54:15', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-04 09:54:15', '2016-01-04 09:54:15', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-04 09:54:15', '2016-01-04 09:54:15', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-04 09:54:15', '2016-01-04 09:54:15', 83783397)[0m
  [1m[35mFixture Delete (10.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$Ttz4dxamRI5TBNQXWDotZOzKEhuVFEP2HPturexHju5jPlZvsdGFe', '2016-01-04 09:54:15', '2016-01-04 09:54:15', 830138774)[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-04 16:54:15 +0700
Processing by WebsiteController#index as HTML
Completed 401 Unauthorized in 37ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:54:15 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:54:15 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:54:15 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:54:15 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:54:15 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:54:15 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:54:15 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (40.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (190.1ms)
Completed 200 OK in 5251ms (Views: 5233.9ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:54:20 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 09:54:21.015138"], ["current_sign_in_at", "2016-01-04 09:54:21.015138"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 09:54:21.016139"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 45ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (6.0ms)
Completed 200 OK in 40ms (Views: 36.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 20ms (Views: 18.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:54:21.160192"], ["updated_at", "2016-01-04 09:54:21.160192"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 6ms (ActiveRecord: 3.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 20ms (Views: 17.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 09:54:21.212211"], ["current_sign_in_at", "2016-01-04 09:54:21.212211"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 09:54:21.213212"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 10ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:54:21.235221"], ["updated_at", "2016-01-04 09:54:21.235221"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 47ms (Views: 7.0ms | ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 09:54:21.311248"], ["current_sign_in_at", "2016-01-04 09:54:21.311248"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 09:54:21.312249"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 09:54:21.351263"], ["current_sign_in_at", "2016-01-04 09:54:21.351263"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 09:54:21.352263"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 09:54:21.440296"], ["current_sign_in_at", "2016-01-04 09:54:21.440296"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 09:54:21.441297"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 13ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 16:54:21 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 09:54:21.491316"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (4.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 09:54:21.497317"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 09:54:21.501319"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:54:21.509322"], ["updated_at", "2016-01-04 09:54:21.509322"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:54:21.511324"], ["updated_at", "2016-01-04 09:54:21.511324"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:54:21.513324"], ["updated_at", "2016-01-04 09:54:21.513324"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:54:21.517326"], ["updated_at", "2016-01-04 09:54:21.517326"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:54:21.522327"], ["updated_at", "2016-01-04 09:54:21.522327"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:54:21.529330"], ["updated_at", "2016-01-04 09:54:21.529330"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:54:21.532331"], ["updated_at", "2016-01-04 09:54:21.532331"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:54:21.534332"], ["updated_at", "2016-01-04 09:54:21.534332"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:54:21.535332"], ["updated_at", "2016-01-04 09:54:21.535332"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (15.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (11.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (8.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-04 09:58:26', '2016-01-04 09:58:26', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-04 09:58:26', '2016-01-04 09:58:26', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-04 09:58:26', '2016-01-04 09:58:26', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-04 09:58:26', '2016-01-04 09:58:26', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-04 09:58:26', '2016-01-04 09:58:26', 83783397)[0m
  [1m[35mFixture Delete (19.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (2.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$qDrscIV6iyYQPeuqw1g20OaaSycBGF0Vo6olB0BvMdcJrwGP1XVf.', '2016-01-04 09:58:26', '2016-01-04 09:58:26', 830138774)[0m
  [1m[35m (9.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:58:26 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (15.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (403.2ms)
Completed 200 OK in 1409ms (Views: 1370.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 09:58:28.074291"], ["current_sign_in_at", "2016-01-04 09:58:28.074291"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 09:58:28.075292"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 36ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (10.0ms)
Completed 200 OK in 46ms (Views: 41.0ms | ActiveRecord: 3.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 21ms (Views: 17.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:58:28.218346"], ["updated_at", "2016-01-04 09:58:28.218346"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 8ms (Views: 5.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 09:58:28.256359"], ["current_sign_in_at", "2016-01-04 09:58:28.256359"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 09:58:28.257359"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 09:58:28.306378"], ["current_sign_in_at", "2016-01-04 09:58:28.306378"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 09:58:28.307378"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 09:58:28.352395"], ["current_sign_in_at", "2016-01-04 09:58:28.352395"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 09:58:28.353396"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 09:58:28.451431"], ["current_sign_in_at", "2016-01-04 09:58:28.451431"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 09:58:28.452433"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:58:28.472440"], ["updated_at", "2016-01-04 09:58:28.472440"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-04 16:58:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:58:28.566474"], ["updated_at", "2016-01-04 09:58:28.566474"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:58:28.568476"], ["updated_at", "2016-01-04 09:58:28.568476"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:58:28.569476"], ["updated_at", "2016-01-04 09:58:28.569476"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:58:28.573477"], ["updated_at", "2016-01-04 09:58:28.573477"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:58:28.575478"], ["updated_at", "2016-01-04 09:58:28.575478"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:58:28.576479"], ["updated_at", "2016-01-04 09:58:28.576479"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:58:28.597486"], ["updated_at", "2016-01-04 09:58:28.597486"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:58:28.600487"], ["updated_at", "2016-01-04 09:58:28.600487"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 09:58:28.604489"], ["updated_at", "2016-01-04 09:58:28.604489"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 09:58:28.611492"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 09:58:28.612492"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 09:58:28.615493"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (10.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (3.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (13.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-04 10:30:09', '2016-01-04 10:30:09', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-04 10:30:09', '2016-01-04 10:30:09', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-04 10:30:09', '2016-01-04 10:30:09', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-04 10:30:09', '2016-01-04 10:30:09', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-04 10:30:09', '2016-01-04 10:30:09', 83783397)[0m
  [1m[35mFixture Delete (21.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$YVASJ0YdYFI3fnECXzELJuwR9EvLzIk3UIfFWIuhgAlYTZ8Jpy7Pm', '2016-01-04 10:30:09', '2016-01-04 10:30:09', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:30:09 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 35ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:30:09 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (138.1ms)
Completed 200 OK in 624ms (Views: 618.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:30:10.652847"], ["current_sign_in_at", "2016-01-04 10:30:10.652847"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:30:10.653848"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 30ms (ActiveRecord: 5.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (9.0ms)
Completed 200 OK in 52ms (Views: 47.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 22ms (Views: 20.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 7ms (Views: 3.0ms | ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:30:10.803904"], ["current_sign_in_at", "2016-01-04 10:30:10.803904"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:30:10.804905"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 9ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 14ms (Views: 12.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:30:10.859924"], ["current_sign_in_at", "2016-01-04 10:30:10.859924"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:30:10.860925"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:30:10.881933"], ["updated_at", "2016-01-04 10:30:10.881933"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:30:10.914945"], ["current_sign_in_at", "2016-01-04 10:30:10.914945"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:30:10.915946"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:30:10.937954"], ["updated_at", "2016-01-04 10:30:10.937954"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:30:10.969966"], ["current_sign_in_at", "2016-01-04 10:30:10.969966"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:30:10.970966"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 30ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:30:10 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (45.0ms)
Completed 200 OK in 48ms (Views: 46.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:30:11 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:30:11 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:30:11.080007"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:30:11.109018"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 10:30:11.111018"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:30:11.118021"], ["updated_at", "2016-01-04 10:30:11.118021"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:30:11.125023"], ["updated_at", "2016-01-04 10:30:11.125023"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:30:11.129025"], ["updated_at", "2016-01-04 10:30:11.129025"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:30:11.131025"], ["updated_at", "2016-01-04 10:30:11.131025"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:30:11.142030"], ["updated_at", "2016-01-04 10:30:11.142030"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:30:11.143030"], ["updated_at", "2016-01-04 10:30:11.143030"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:30:11.145031"], ["updated_at", "2016-01-04 10:30:11.145031"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:30:11.149032"], ["updated_at", "2016-01-04 10:30:11.149032"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:30:11.154034"], ["updated_at", "2016-01-04 10:30:11.154034"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:30:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/website/" for 127.0.0.1 at 2016-01-04 17:30:11 +0700
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:30:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:30:11 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:30:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:30:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:30:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:30:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:30:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (13.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (3.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (10.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (15.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-04 10:37:05', '2016-01-04 10:37:05', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-04 10:37:05', '2016-01-04 10:37:05', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-04 10:37:05', '2016-01-04 10:37:05', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-04 10:37:05', '2016-01-04 10:37:05', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-04 10:37:05', '2016-01-04 10:37:05', 83783397)[0m
  [1m[35mFixture Delete (19.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$zXagCrqsqHC.1XgOXmD6Aet3SkA7Gthzk4UXi1pKw1vaBLAHd/UZG', '2016-01-04 10:37:05', '2016-01-04 10:37:05', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:37:05 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (405.2ms)
Completed 200 OK in 863ms (Views: 831.4ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:37:06 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:37:06.811197"], ["current_sign_in_at", "2016-01-04 10:37:06.811197"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:37:06.812198"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 44ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:37:06 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (10.0ms)
Completed 200 OK in 50ms (Views: 47.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:37:06 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 11ms (Views: 8.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:37:06 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:37:06 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (12.0ms)
Completed 200 OK in 14ms (Views: 13.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:37:06 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:37:06.986271"], ["current_sign_in_at", "2016-01-04 10:37:06.986271"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:37:06.987272"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:37:06 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:37:06 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 16ms (Views: 14.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:37:07.065304"], ["current_sign_in_at", "2016-01-04 10:37:07.065304"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:37:07.066304"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:37:07.088315"], ["updated_at", "2016-01-04 10:37:07.088315"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:37:07.121328"], ["current_sign_in_at", "2016-01-04 10:37:07.121328"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:37:07.122329"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:37:07.207364"], ["current_sign_in_at", "2016-01-04 10:37:07.207364"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:37:07.208366"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:37:07.229374"], ["updated_at", "2016-01-04 10:37:07.229374"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:37:07.270391"], ["updated_at", "2016-01-04 10:37:07.270391"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:37:07.272393"], ["updated_at", "2016-01-04 10:37:07.272393"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:37:07.274393"], ["updated_at", "2016-01-04 10:37:07.274393"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:37:07.277394"], ["updated_at", "2016-01-04 10:37:07.277394"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:37:07.279395"], ["updated_at", "2016-01-04 10:37:07.279395"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:37:07.280395"], ["updated_at", "2016-01-04 10:37:07.280395"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:37:07.287398"], ["updated_at", "2016-01-04 10:37:07.287398"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:37:07.290400"], ["updated_at", "2016-01-04 10:37:07.290400"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:37:07.292401"], ["updated_at", "2016-01-04 10:37:07.292401"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by WebsiteController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:37:07 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (11.0ms)
Completed 200 OK in 14ms (Views: 13.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:37:07.397445"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 10:37:07.399446"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:37:07.404448"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (16.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (6.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (20.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (14.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-04 10:42:45', '2016-01-04 10:42:45', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-04 10:42:45', '2016-01-04 10:42:45', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-04 10:42:45', '2016-01-04 10:42:45', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-04 10:42:45', '2016-01-04 10:42:45', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-04 10:42:45', '2016-01-04 10:42:45', 83783397)[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$9VHEjsHc5medvgNYSmjcTOpdP90aDFVaL0QxRLortKXsOnK9G9bLy', '2016-01-04 10:42:45', '2016-01-04 10:42:45', 830138774)[0m
  [1m[35m (8.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:42:45.939390"], ["updated_at", "2016-01-04 10:42:45.939390"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:42:45.946393"], ["updated_at", "2016-01-04 10:42:45.946393"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:42:45.948394"], ["updated_at", "2016-01-04 10:42:45.948394"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:42:45.952395"], ["updated_at", "2016-01-04 10:42:45.952395"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:42:46.012419"], ["updated_at", "2016-01-04 10:42:46.012419"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:42:46.016420"], ["updated_at", "2016-01-04 10:42:46.016420"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:42:46.018421"], ["updated_at", "2016-01-04 10:42:46.018421"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:42:46.021423"], ["updated_at", "2016-01-04 10:42:46.021423"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:42:46.028425"], ["updated_at", "2016-01-04 10:42:46.028425"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:42:46 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 36ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:42:46 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (171.1ms)
Completed 200 OK in 712ms (Views: 702.3ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:42:46 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:42:46.951786"], ["current_sign_in_at", "2016-01-04 10:42:46.951786"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:42:46.952786"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 33ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:42:46 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (6.0ms)
Completed 200 OK in 66ms (Views: 61.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 14ms (Views: 11.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (15.0ms)
Completed 200 OK in 24ms (Views: 21.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 13ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:42:47.427972"], ["current_sign_in_at", "2016-01-04 10:42:47.427972"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:42:47.428973"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:42:47.475991"], ["current_sign_in_at", "2016-01-04 10:42:47.475991"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:42:47.476992"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 43ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:42:47.554021"], ["current_sign_in_at", "2016-01-04 10:42:47.554021"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:42:47.555022"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:42:47.576030"], ["updated_at", "2016-01-04 10:42:47.576030"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:42:47.608042"], ["current_sign_in_at", "2016-01-04 10:42:47.608042"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:42:47.609043"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:42:47.631052"], ["updated_at", "2016-01-04 10:42:47.631052"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (5.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by WebsiteController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:42:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:42:47.747098"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:42:47.753100"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 10:42:47.759102"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (15.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (11.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (2.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (12.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-04 10:43:43', '2016-01-04 10:43:43', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-04 10:43:43', '2016-01-04 10:43:43', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-04 10:43:43', '2016-01-04 10:43:43', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-04 10:43:43', '2016-01-04 10:43:43', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-04 10:43:43', '2016-01-04 10:43:43', 83783397)[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$BIncgsPJWevkBfAeIMiL0.QrSpMtFQvkyzY6KU4VLSpihY9RrbRyu', '2016-01-04 10:43:43', '2016-01-04 10:43:43', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:43:43.842029"], ["updated_at", "2016-01-04 10:43:43.842029"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:43:43.894049"], ["updated_at", "2016-01-04 10:43:43.894049"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:43:43.896050"], ["updated_at", "2016-01-04 10:43:43.896050"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:43:43.897051"], ["updated_at", "2016-01-04 10:43:43.897051"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:43:43.901052"], ["updated_at", "2016-01-04 10:43:43.901052"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:43:43.903053"], ["updated_at", "2016-01-04 10:43:43.903053"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:43:43.904054"], ["updated_at", "2016-01-04 10:43:43.904054"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:43:43.911056"], ["updated_at", "2016-01-04 10:43:43.911056"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:43:43.916059"], ["updated_at", "2016-01-04 10:43:43.916059"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:43:43 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 38ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:43:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:43:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:43:44 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (13.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (548.2ms)
Completed 200 OK in 1146ms (Views: 1136.4ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by WebsiteController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 13ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (3.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:43:45.342616"], ["current_sign_in_at", "2016-01-04 10:43:45.342616"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:43:45.343616"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 36ms (ActiveRecord: 5.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 50ms (Views: 47.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (11.0ms)
Completed 200 OK in 21ms (Views: 18.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:43:45.471667"], ["updated_at", "2016-01-04 10:43:45.471667"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (45.0ms)
Completed 200 OK in 47ms (Views: 46.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:43:45.553698"], ["current_sign_in_at", "2016-01-04 10:43:45.553698"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:43:45.554699"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 13ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:43:45.603718"], ["current_sign_in_at", "2016-01-04 10:43:45.603718"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:43:45.604718"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (5.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 11ms (Views: 11.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:43:45.705758"], ["current_sign_in_at", "2016-01-04 10:43:45.705758"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:43:45.706758"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 9ms (Views: 6.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:43:45.731769"], ["updated_at", "2016-01-04 10:43:45.731769"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:43:45.773784"], ["current_sign_in_at", "2016-01-04 10:43:45.773784"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:43:45.774785"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 13ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:43:45 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:43:45.798794"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 10:43:45.800796"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:43:45.805797"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (14.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (10.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (7.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (13.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-04 10:48:32', '2016-01-04 10:48:32', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-04 10:48:32', '2016-01-04 10:48:32', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-04 10:48:32', '2016-01-04 10:48:32', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-04 10:48:32', '2016-01-04 10:48:32', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-04 10:48:32', '2016-01-04 10:48:32', 83783397)[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$Tpbh6a54DsDPtj45avEENOCulLgb8ooyQobghmi8YAjlhnsbTx3Hi', '2016-01-04 10:48:32', '2016-01-04 10:48:32', 830138774)[0m
  [1m[35m (4.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:48:32 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (217.1ms)
Completed 200 OK in 671ms (Views: 635.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:48:32 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:48:32.978345"], ["current_sign_in_at", "2016-01-04 10:48:32.978345"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:48:32.979345"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 34ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:48:32 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (8.0ms)
Completed 200 OK in 43ms (Views: 40.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 13ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:48:33.143408"], ["current_sign_in_at", "2016-01-04 10:48:33.143408"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:48:33.144408"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 11ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 6.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 14ms (Views: 11.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:48:33.396504"], ["current_sign_in_at", "2016-01-04 10:48:33.396504"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:48:33.398504"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (7.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 12ms (Views: 2.0ms | ActiveRecord: 7.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:48:33.450523"], ["current_sign_in_at", "2016-01-04 10:48:33.450523"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:48:33.451524"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:48:33.512547"], ["updated_at", "2016-01-04 10:48:33.512547"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:48:33.544559"], ["current_sign_in_at", "2016-01-04 10:48:33.544559"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:48:33.545559"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 12ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:48:33.574570"], ["updated_at", "2016-01-04 10:48:33.574570"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 3ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (5.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by WebsiteController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:48:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:48:33.662604"], ["updated_at", "2016-01-04 10:48:33.662604"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:48:33.664604"], ["updated_at", "2016-01-04 10:48:33.664604"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:48:33.665605"], ["updated_at", "2016-01-04 10:48:33.665605"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:48:33.670607"], ["updated_at", "2016-01-04 10:48:33.670607"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:48:33.672608"], ["updated_at", "2016-01-04 10:48:33.672608"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:48:33.679610"], ["updated_at", "2016-01-04 10:48:33.679610"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:48:33.681611"], ["updated_at", "2016-01-04 10:48:33.681611"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:48:33.682611"], ["updated_at", "2016-01-04 10:48:33.682611"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:48:33.685612"], ["updated_at", "2016-01-04 10:48:33.685612"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:48:33.714624"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 10:48:33.716624"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:48:33.719625"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (43.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (3.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (12.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (13.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-04 10:49:48', '2016-01-04 10:49:48', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-04 10:49:48', '2016-01-04 10:49:48', 459292723)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-04 10:49:48', '2016-01-04 10:49:48', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-04 10:49:48', '2016-01-04 10:49:48', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-04 10:49:48', '2016-01-04 10:49:48', 83783397)[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$tMy.rtfJ47Q5CamD4lAwWeAfsGp9uFkm5n.2H7g81ZF9H6ww/LO1y', '2016-01-04 10:49:48', '2016-01-04 10:49:48', 830138774)[0m
  [1m[35m (2.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 10:49:48.736148"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 10:49:48.769161"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:49:48.772162"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:49:48 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
Completed 401 Unauthorized in 43ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:49:48 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:49:48 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:49:48 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:49:49 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:49:49 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:49:49 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (271.1ms)
Completed 200 OK in 1047ms (Views: 1021.4ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by WebsiteController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:49:50.153685"], ["current_sign_in_at", "2016-01-04 10:49:50.153685"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:49:50.155686"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 36ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 42ms (Views: 37.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (11.0ms)
Completed 200 OK in 19ms (Views: 17.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:49:50.265727"], ["updated_at", "2016-01-04 10:49:50.265727"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (5.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 59ms (Views: 59.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:49:50.354761"], ["current_sign_in_at", "2016-01-04 10:49:50.354761"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:49:50.355762"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:49:50.403779"], ["current_sign_in_at", "2016-01-04 10:49:50.403779"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:49:50.404780"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 6ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:49:50.426788"], ["updated_at", "2016-01-04 10:49:50.426788"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:49:50.458800"], ["current_sign_in_at", "2016-01-04 10:49:50.458800"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:49:50.459801"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 13ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:49:50.513821"], ["current_sign_in_at", "2016-01-04 10:49:50.513821"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:49:50.514821"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:49:50 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:49:50.560839"], ["updated_at", "2016-01-04 10:49:50.560839"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:49:50.565841"], ["updated_at", "2016-01-04 10:49:50.565841"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:49:50.576845"], ["updated_at", "2016-01-04 10:49:50.576845"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:49:50.578846"], ["updated_at", "2016-01-04 10:49:50.578846"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:49:50.581847"], ["updated_at", "2016-01-04 10:49:50.581847"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:49:50.586849"], ["updated_at", "2016-01-04 10:49:50.586849"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:49:50.593852"], ["updated_at", "2016-01-04 10:49:50.593852"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:49:50.595852"], ["updated_at", "2016-01-04 10:49:50.595852"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:49:50.597854"], ["updated_at", "2016-01-04 10:49:50.597854"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (14.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (5.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (20.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-04 10:56:08', '2016-01-04 10:56:08', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-04 10:56:08', '2016-01-04 10:56:08', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-04 10:56:08', '2016-01-04 10:56:08', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-04 10:56:08', '2016-01-04 10:56:08', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-04 10:56:08', '2016-01-04 10:56:08', 83783397)[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$YsCU7xNLq5HEwL7oGDptJu2lfGM1jEcCjXbcLgjuIWQnm57eK7ngC', '2016-01-04 10:56:08', '2016-01-04 10:56:08', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:56:08.723603"], ["updated_at", "2016-01-04 10:56:08.723603"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:56:08.782627"], ["updated_at", "2016-01-04 10:56:08.782627"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:56:08.784627"], ["updated_at", "2016-01-04 10:56:08.784627"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:56:08.785627"], ["updated_at", "2016-01-04 10:56:08.785627"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:56:08.789628"], ["updated_at", "2016-01-04 10:56:08.789628"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:56:08.844649"], ["updated_at", "2016-01-04 10:56:08.844649"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:56:08.848651"], ["updated_at", "2016-01-04 10:56:08.848651"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:56:08.850651"], ["updated_at", "2016-01-04 10:56:08.850651"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:56:08.851651"], ["updated_at", "2016-01-04 10:56:08.851651"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:56:08 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (162.1ms)
Completed 200 OK in 954ms (Views: 918.3ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:56:09 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:56:09.910045"], ["current_sign_in_at", "2016-01-04 10:56:09.910045"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:56:09.911046"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 32ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:56:09 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (7.0ms)
Completed 200 OK in 44ms (Views: 41.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:56:09 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 18ms (Views: 15.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:56:10.036092"], ["updated_at", "2016-01-04 10:56:10.036092"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 13ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:56:10.077107"], ["current_sign_in_at", "2016-01-04 10:56:10.077107"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:56:10.078108"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 7ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:56:10.180145"], ["current_sign_in_at", "2016-01-04 10:56:10.180145"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:56:10.181146"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:56:10.242168"], ["current_sign_in_at", "2016-01-04 10:56:10.242168"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:56:10.243169"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:56:10.268179"], ["updated_at", "2016-01-04 10:56:10.268179"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:56:10.305191"], ["current_sign_in_at", "2016-01-04 10:56:10.305191"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:56:10.306192"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by WebsiteController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (5.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:56:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:56:10.442243"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 10:56:10.445244"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:56:10.450246"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (11.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (6.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (14.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-04 10:57:29', '2016-01-04 10:57:29', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-04 10:57:29', '2016-01-04 10:57:29', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-04 10:57:29', '2016-01-04 10:57:29', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-04 10:57:29', '2016-01-04 10:57:29', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-04 10:57:29', '2016-01-04 10:57:29', 83783397)[0m
  [1m[35mFixture Delete (14.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$e2rquQinteYX7ats3PQZweP30sZ2Kw3gf.jrcdULxFdMltsGNt./6', '2016-01-04 10:57:29', '2016-01-04 10:57:29', 830138774)[0m
  [1m[35m (7.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:57:29 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 40ms (ActiveRecord: 0.0ms)
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:57:29 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (189.1ms)
Completed 200 OK in 1151ms (Views: 1114.4ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:57:30 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-04 17:57:30 +0700
Processing by WebsiteController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:57:30 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:57:30 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:57:30 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:57:30 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-04 17:57:30 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:57:30 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:57:31 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (2.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (4.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:57:31.030739"], ["current_sign_in_at", "2016-01-04 10:57:31.030739"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:57:31.031740"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 50ms (ActiveRecord: 7.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:57:31 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (3.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (11.0ms)
Completed 200 OK in 62ms (Views: 57.0ms | ActiveRecord: 3.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:57:31 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (63.0ms)
Completed 200 OK in 73ms (Views: 70.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:57:31 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:57:31.579944"], ["updated_at", "2016-01-04 10:57:31.579944"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:57:31 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (168.1ms)
Completed 200 OK in 172ms (Views: 170.1ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:57:31 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:57:31 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:57:31.781018"], ["current_sign_in_at", "2016-01-04 10:57:31.781018"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:57:31.782019"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:57:31 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:57:31 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:57:32.247279"], ["current_sign_in_at", "2016-01-04 10:57:32.247279"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:57:32.252281"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 12ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:57:32.275290"], ["updated_at", "2016-01-04 10:57:32.275290"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 10:57:32.310303"], ["current_sign_in_at", "2016-01-04 10:57:32.310303"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:57:32.311303"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by WebsiteController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 10:57:32.368324"], ["current_sign_in_at", "2016-01-04 10:57:32.368324"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 10:57:32.369325"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by WebsiteController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 17:57:32 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:57:32.407341"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 10:57:32.410340"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 10:57:32.414342"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:57:32.418343"], ["updated_at", "2016-01-04 10:57:32.418343"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:57:32.421344"], ["updated_at", "2016-01-04 10:57:32.421344"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:57:32.422344"], ["updated_at", "2016-01-04 10:57:32.422344"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:57:32.424345"], ["updated_at", "2016-01-04 10:57:32.424345"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:57:32.428347"], ["updated_at", "2016-01-04 10:57:32.428347"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:57:32.433349"], ["updated_at", "2016-01-04 10:57:32.433349"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:57:32.441351"], ["updated_at", "2016-01-04 10:57:32.441351"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:57:32.443352"], ["updated_at", "2016-01-04 10:57:32.443352"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 10:57:32.444353"], ["updated_at", "2016-01-04 10:57:32.444353"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (20.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (9.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (3.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (12.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-04 11:00:21', '2016-01-04 11:00:21', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-04 11:00:21', '2016-01-04 11:00:21', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-04 11:00:21', '2016-01-04 11:00:21', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-04 11:00:21', '2016-01-04 11:00:21', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-04 11:00:21', '2016-01-04 11:00:21', 83783397)[0m
  [1m[35mFixture Delete (1.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$0JUxJvG0ouI7p8yOZBkP0Oeoq9PXxTn5T4v5LoOKbpuEqOY/ODwGq', '2016-01-04 11:00:21', '2016-01-04 11:00:21', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 11:00:21.274948"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-04 11:00:21.279950"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-04 11:00:21.288953"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 11:00:21.323966"], ["updated_at", "2016-01-04 11:00:21.323966"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 11:00:21.326968"], ["updated_at", "2016-01-04 11:00:21.326968"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 11:00:21.328968"], ["updated_at", "2016-01-04 11:00:21.328968"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 11:00:21.334970"], ["updated_at", "2016-01-04 11:00:21.334970"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 11:00:21.336971"], ["updated_at", "2016-01-04 11:00:21.336971"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 11:00:21.338972"], ["updated_at", "2016-01-04 11:00:21.338972"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (2.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 11:00:21.344974"], ["updated_at", "2016-01-04 11:00:21.344974"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 11:00:21.353977"], ["updated_at", "2016-01-04 11:00:21.353977"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 11:00:21.414000"], ["updated_at", "2016-01-04 11:00:21.414000"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 18:00:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (173.1ms)
Completed 200 OK in 2025ms (Views: 1990.9ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 11:00:23.561913"], ["current_sign_in_at", "2016-01-04 11:00:23.561913"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 11:00:23.562913"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 31ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 55ms (Views: 53.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 26ms (Views: 20.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 11:00:23.736978"], ["updated_at", "2016-01-04 11:00:23.736978"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (5.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 11:00:23.776993"], ["current_sign_in_at", "2016-01-04 11:00:23.776993"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 11:00:23.777993"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-04 11:00:23.863025"], ["current_sign_in_at", "2016-01-04 11:00:23.863025"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 11:00:23.864025"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 11:00:23.936052"], ["current_sign_in_at", "2016-01-04 11:00:23.936052"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 11:00:23.937052"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-04 11:00:23.987071"], ["current_sign_in_at", "2016-01-04 11:00:23.987071"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-04 11:00:23.988071"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-04 18:00:23 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-04 18:00:24 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-04 11:00:24.008079"], ["updated_at", "2016-01-04 11:00:24.008079"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 18:00:24 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 2.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-04 18:00:24 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 18:00:24 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", "563589564"]]
  [1m[35mCACHE (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", "563589564"]]
Completed 500 Internal Server Error in 777ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 18:00:24 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 12ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 18:00:24 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCACHE (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", "563589564"]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", "563589564"]]
Completed 500 Internal Server Error in 328ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 18:00:25 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-04 18:00:25 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-04 18:00:25 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-04 18:00:25 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-04 18:00:25 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 0]]
Completed 404 Not Found in 1ms (ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (11.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (4.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (14.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (11.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:04:23', '2016-01-05 05:04:23', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:04:23', '2016-01-05 05:04:23', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:04:23', '2016-01-05 05:04:23', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:04:23', '2016-01-05 05:04:23', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:04:23', '2016-01-05 05:04:23', 83783397)[0m
  [1m[35mFixture Delete (17.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$1Wta9Fw8fHq4S6eKEeIGvuT37oP2sSTXjqXvlMOfri5drlQJnkClC', '2016-01-05 05:04:23', '2016-01-05 05:04:23', 830138774)[0m
  [1m[35m (7.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:04:24 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (50.0ms)
Completed 500 Internal Server Error in 548ms (Views: 462.2ms | ActiveRecord: 2.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:04:24 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:04:24 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:04:24 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
Completed 500 Internal Server Error in 387ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:04:25 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:04:25 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:04:25 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 391ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:04:25 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 394ms (ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (2.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:04:25.923536"], ["updated_at", "2016-01-05 05:04:25.923536"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:04:25.937541"], ["updated_at", "2016-01-05 05:04:25.937541"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:04:25.939543"], ["updated_at", "2016-01-05 05:04:25.939543"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:04:25.941543"], ["updated_at", "2016-01-05 05:04:25.941543"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:04:25.963552"], ["updated_at", "2016-01-05 05:04:25.963552"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:04:25.967553"], ["updated_at", "2016-01-05 05:04:25.967553"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:04:25.968553"], ["updated_at", "2016-01-05 05:04:25.968553"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:04:25.972555"], ["updated_at", "2016-01-05 05:04:25.972555"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:04:25.975556"], ["updated_at", "2016-01-05 05:04:25.975556"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:04:25.983559"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:04:25.988562"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:04:25.992563"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:04:25 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (11.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (136.1ms)
Completed 200 OK in 175ms (Views: 164.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:04:26.215648"], ["current_sign_in_at", "2016-01-05 05:04:26.215648"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:04:26.216648"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 28ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 20ms (Views: 17.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:04:26.283674"], ["updated_at", "2016-01-05 05:04:26.283674"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 16ms (Views: 13.0ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:04:26.377711"], ["current_sign_in_at", "2016-01-05 05:04:26.377711"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:04:26.378711"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:04:26.435733"], ["current_sign_in_at", "2016-01-05 05:04:26.435733"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:04:26.436733"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:04:26.480750"], ["current_sign_in_at", "2016-01-05 05:04:26.480750"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:04:26.481751"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (3.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:04:26.501758"], ["updated_at", "2016-01-05 05:04:26.501758"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 6ms (ActiveRecord: 6.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:04:26.536771"], ["current_sign_in_at", "2016-01-05 05:04:26.536771"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:04:26.537772"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:04:26 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (9.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (2.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (14.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:08:28', '2016-01-05 05:08:28', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:08:28', '2016-01-05 05:08:28', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:08:28', '2016-01-05 05:08:28', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:08:28', '2016-01-05 05:08:28', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:08:28', '2016-01-05 05:08:28', 83783397)[0m
  [1m[35mFixture Delete (17.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$O/IvWkMvC.qHPtZ9SfiT1eBkuQUWudQj.UWifsaVMAqD2.IEBGHba', '2016-01-05 05:08:28', '2016-01-05 05:08:28', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:08:28 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (4.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (99.0ms)
Completed 200 OK in 1918ms (Views: 1885.8ms | ActiveRecord: 4.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:08:30 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:08:30 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"random"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
Completed 500 Internal Server Error in 567ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:08:31 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:08:31 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 289ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:08:31 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 389ms (ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:08:32 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:08:32 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 500 Internal Server Error in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (3.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:08:32.363101"], ["updated_at", "2016-01-05 05:08:32.363101"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:08:32.368102"], ["updated_at", "2016-01-05 05:08:32.368102"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:08:32.370103"], ["updated_at", "2016-01-05 05:08:32.370103"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:08:32.375105"], ["updated_at", "2016-01-05 05:08:32.375105"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:08:32.378106"], ["updated_at", "2016-01-05 05:08:32.378106"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:08:32.386109"], ["updated_at", "2016-01-05 05:08:32.386109"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:08:32.388110"], ["updated_at", "2016-01-05 05:08:32.388110"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:08:32.389111"], ["updated_at", "2016-01-05 05:08:32.389111"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:08:32.396113"], ["updated_at", "2016-01-05 05:08:32.396113"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (4.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (8.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:08:32.409119"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:08:32.526233"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:08:32.531238"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:08:32 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 84ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:08:32 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (9.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (149.1ms)
Completed 200 OK in 260ms (Views: 212.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:08:33.147505"], ["current_sign_in_at", "2016-01-05 05:08:33.147505"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:08:33.149506"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 30ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 64ms (Views: 61.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 15ms (Views: 13.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:08:33.302565"], ["current_sign_in_at", "2016-01-05 05:08:33.302565"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:08:33.303565"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:08:33.351584"], ["current_sign_in_at", "2016-01-05 05:08:33.351584"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:08:33.352584"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:08:33.391599"], ["current_sign_in_at", "2016-01-05 05:08:33.391599"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:08:33.392600"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:08:33.413608"], ["updated_at", "2016-01-05 05:08:33.413608"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:08:33.447620"], ["current_sign_in_at", "2016-01-05 05:08:33.447620"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:08:33.448621"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:08:33.469629"], ["updated_at", "2016-01-05 05:08:33.469629"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:08:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (27.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (6.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (17.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (13.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:16:33', '2016-01-05 05:16:33', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:16:33', '2016-01-05 05:16:33', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:16:33', '2016-01-05 05:16:33', 103210531)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:16:33', '2016-01-05 05:16:33', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:16:33', '2016-01-05 05:16:33', 83783397)[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$18nV4xNfjcM40zkxOdyPXueOKHJk2ETYCbttCsh/mkjaaVbgcH.oS', '2016-01-05 05:16:34', '2016-01-05 05:16:34', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:16:34 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 36ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:16:34 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (157.1ms)
Completed 200 OK in 577ms (Views: 573.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:16:34 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:16:34.892723"], ["current_sign_in_at", "2016-01-05 05:16:34.892723"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:16:34.893723"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 33ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:16:34 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (2.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (10.0ms)
Completed 200 OK in 60ms (Views: 56.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 20ms (Views: 16.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 13ms (Views: 11.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 16ms (Views: 14.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:16:35.087796"], ["current_sign_in_at", "2016-01-05 05:16:35.087796"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:16:35.089797"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (2.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:16:35.113806"], ["updated_at", "2016-01-05 05:16:35.113806"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 8ms (Views: 5.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (44.0ms)
Completed 200 OK in 46ms (Views: 46.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:16:35.184832"], ["current_sign_in_at", "2016-01-05 05:16:35.184832"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:16:35.185833"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:16:35.223848"], ["current_sign_in_at", "2016-01-05 05:16:35.223848"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:16:35.224848"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:16:35.244855"], ["updated_at", "2016-01-05 05:16:35.244855"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:16:35.275867"], ["current_sign_in_at", "2016-01-05 05:16:35.275867"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:16:35.276867"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (53.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 59ms (Views: 3.0ms | ActiveRecord: 53.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:16:35.358898"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:16:35.369904"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:16:35.371904"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:16:35.379907"], ["updated_at", "2016-01-05 05:16:35.379907"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:16:35.381907"], ["updated_at", "2016-01-05 05:16:35.381907"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:16:35.382908"], ["updated_at", "2016-01-05 05:16:35.382908"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:16:35.390910"], ["updated_at", "2016-01-05 05:16:35.390910"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:16:35.393912"], ["updated_at", "2016-01-05 05:16:35.393912"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:16:35.401915"], ["updated_at", "2016-01-05 05:16:35.401915"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:16:35.402915"], ["updated_at", "2016-01-05 05:16:35.402915"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:16:35.404916"], ["updated_at", "2016-01-05 05:16:35.404916"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:16:35.407918"], ["updated_at", "2016-01-05 05:16:35.407918"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:16:35 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 640ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:16:36 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>""}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (7.0ms)
Completed 500 Internal Server Error in 10ms (Views: 9.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:16:36 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 275ms (ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:16:36 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 317ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:16:36 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:16:36 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:16:36 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (14.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (4.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (16.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:17:46', '2016-01-05 05:17:46', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:17:46', '2016-01-05 05:17:46', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:17:46', '2016-01-05 05:17:46', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:17:46', '2016-01-05 05:17:46', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:17:46', '2016-01-05 05:17:46', 83783397)[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$2m2ZxZe2sZ1RqVURyD4e6.Uf.8ass/eibyp3NTiz0ViGs33Yv0X5G', '2016-01-05 05:17:46', '2016-01-05 05:17:46', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:17:46.234701"], ["updated_at", "2016-01-05 05:17:46.234701"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:17:46.239703"], ["updated_at", "2016-01-05 05:17:46.239703"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:17:46.270715"], ["updated_at", "2016-01-05 05:17:46.270715"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:17:46.305728"], ["updated_at", "2016-01-05 05:17:46.305728"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:17:46.307729"], ["updated_at", "2016-01-05 05:17:46.307729"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:17:46.309730"], ["updated_at", "2016-01-05 05:17:46.309730"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:17:46.323735"], ["updated_at", "2016-01-05 05:17:46.323735"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:17:46.325736"], ["updated_at", "2016-01-05 05:17:46.325736"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:17:46.326736"], ["updated_at", "2016-01-05 05:17:46.326736"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:17:46.333739"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:17:46.337740"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:17:46.341742"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:17:46 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (134.1ms)
Completed 200 OK in 609ms (Views: 568.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:17:47.048018"], ["current_sign_in_at", "2016-01-05 05:17:47.048018"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:17:47.049018"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 29ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 51ms (Views: 49.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 17ms (Views: 15.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:17:47.223085"], ["updated_at", "2016-01-05 05:17:47.223085"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 16ms (Views: 13.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (5.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 12ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:17:47.268101"], ["current_sign_in_at", "2016-01-05 05:17:47.268101"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:17:47.269102"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 42ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:17:47.328125"], ["updated_at", "2016-01-05 05:17:47.328125"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:17:47.360136"], ["current_sign_in_at", "2016-01-05 05:17:47.360136"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:17:47.361136"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:17:47.424160"], ["current_sign_in_at", "2016-01-05 05:17:47.424160"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:17:47.425161"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (11.0ms)
Completed 200 OK in 14ms (Views: 13.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:17:47.467177"], ["current_sign_in_at", "2016-01-05 05:17:47.467177"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:17:47.468177"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
Completed 500 Internal Server Error in 409ms (ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>""}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 500 Internal Server Error in 5ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:17:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:17:48 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 273ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:17:48 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 341ms (ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (91.1ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (7.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (2.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (12.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (11.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:26:56', '2016-01-05 05:26:56', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:26:56', '2016-01-05 05:26:56', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:26:56', '2016-01-05 05:26:56', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:26:56', '2016-01-05 05:26:56', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:26:56', '2016-01-05 05:26:56', 83783397)[0m
  [1m[35mFixture Delete (107.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$MyqIWqL7zI2gQxg9SB.Bp.JS3L2eZSSVuEmAmvc63PLGY13J0ShrC', '2016-01-05 05:26:56', '2016-01-05 05:26:56', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 05:26:56.783774"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:26:56.788776"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:26:56.794778"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:26:56 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
Completed 500 Internal Server Error in 549ms (ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:26:57 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (13.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 759ms (Views: 588.2ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:26:58 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>""}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 500 Internal Server Error in 7ms (Views: 7.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:26:58 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:26:58 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 394ms (ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:26:58 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:26:58 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:26:58 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<OpenStruct id=\"tokn_X\", card=#<OpenStruct name=\"J DOE\", last_digits=\"4242\", expiration_month=10, expiration_year=2020, security_code_check=false>>", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 371ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (180.1ms)
Completed 200 OK in 213ms (Views: 205.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:26:59.277743"], ["current_sign_in_at", "2016-01-05 05:26:59.277743"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:26:59.278743"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 28ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 19ms (Views: 16.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:26:59.350770"], ["updated_at", "2016-01-05 05:26:59.350770"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 19ms (Views: 17.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:26:59.398789"], ["current_sign_in_at", "2016-01-05 05:26:59.398789"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:26:59.399789"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:26:59.419797"], ["updated_at", "2016-01-05 05:26:59.419797"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:26:59.454809"], ["current_sign_in_at", "2016-01-05 05:26:59.454809"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:26:59.455810"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:26:59.503828"], ["current_sign_in_at", "2016-01-05 05:26:59.503828"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:26:59.504828"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:26:59.553847"], ["current_sign_in_at", "2016-01-05 05:26:59.553847"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:26:59.554848"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:26:59 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:26:59.602866"], ["updated_at", "2016-01-05 05:26:59.602866"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:26:59.604867"], ["updated_at", "2016-01-05 05:26:59.604867"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:26:59.606867"], ["updated_at", "2016-01-05 05:26:59.606867"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:26:59.609868"], ["updated_at", "2016-01-05 05:26:59.609868"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:26:59.611869"], ["updated_at", "2016-01-05 05:26:59.611869"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:26:59.616871"], ["updated_at", "2016-01-05 05:26:59.616871"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:26:59.618872"], ["updated_at", "2016-01-05 05:26:59.618872"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:26:59.620873"], ["updated_at", "2016-01-05 05:26:59.620873"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:26:59.636879"], ["updated_at", "2016-01-05 05:26:59.636879"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (13.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (5.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (12.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:30:52', '2016-01-05 05:30:52', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:30:52', '2016-01-05 05:30:52', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:30:52', '2016-01-05 05:30:52', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:30:52', '2016-01-05 05:30:52', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:30:52', '2016-01-05 05:30:52', 83783397)[0m
  [1m[35mFixture Delete (14.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$eXh6qy1KW8sfWortxjAoTOpsnUxOlc4XIFgDdpV5IY54i6bN04g8K', '2016-01-05 05:30:52', '2016-01-05 05:30:52', 830138774)[0m
  [1m[35m (8.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:30:52.487816"], ["updated_at", "2016-01-05 05:30:52.487816"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:30:52.492818"], ["updated_at", "2016-01-05 05:30:52.492818"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:30:52.494819"], ["updated_at", "2016-01-05 05:30:52.494819"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:30:52.495819"], ["updated_at", "2016-01-05 05:30:52.495819"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:30:52.550841"], ["updated_at", "2016-01-05 05:30:52.550841"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:30:52.552842"], ["updated_at", "2016-01-05 05:30:52.552842"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:30:52.553842"], ["updated_at", "2016-01-05 05:30:52.553842"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:30:52.557843"], ["updated_at", "2016-01-05 05:30:52.557843"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:30:52.562846"], ["updated_at", "2016-01-05 05:30:52.562846"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:30:52 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (12.0ms)
Completed 500 Internal Server Error in 618ms (Views: 590.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:30:53 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:30:54 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 1642ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:30:56 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:30:56 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
Completed 500 Internal Server Error in 397ms (ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:30:56 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:30:56 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 340ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:30:57 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (27.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-05 05:30:57.123426"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:30:57.193454"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:30:57.198455"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:30:57 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (48.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (191.1ms)
Completed 200 OK in 259ms (Views: 234.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:30:57 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:30:57.880807"], ["current_sign_in_at", "2016-01-05 05:30:57.880807"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:30:57.881807"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 30ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:30:57 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:30:57 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 18ms (Views: 16.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:30:57 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:30:57.968841"], ["updated_at", "2016-01-05 05:30:57.968841"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:30:57 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 18ms (Views: 17.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:30:57 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:30:58.014859"], ["current_sign_in_at", "2016-01-05 05:30:58.014859"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:30:58.015859"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:30:58.064878"], ["current_sign_in_at", "2016-01-05 05:30:58.064878"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:30:58.065878"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:30:58.136907"], ["current_sign_in_at", "2016-01-05 05:30:58.136907"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:30:58.137907"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:30:58.184925"], ["current_sign_in_at", "2016-01-05 05:30:58.184925"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:30:58.185925"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:30:58.205934"], ["updated_at", "2016-01-05 05:30:58.205934"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:30:58 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (20.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (11.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (14.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:38:30', '2016-01-05 05:38:30', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:38:30', '2016-01-05 05:38:30', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:38:30', '2016-01-05 05:38:30', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:38:30', '2016-01-05 05:38:30', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:38:30', '2016-01-05 05:38:30', 83783397)[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$vIYGAWgAtic6iMkkhuFqk.m5hwtfxLkiZ302WqccI8S5fLo59F5f6', '2016-01-05 05:38:30', '2016-01-05 05:38:30', 830138774)[0m
  [1m[35m (7.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 05:38:30.631702"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:38:30.635704"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:38:30.641706"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:38:30 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (94.0ms)
Completed 200 OK in 1321ms (Views: 1291.5ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:38:32 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (4.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:38:32 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:38:32 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 500 Internal Server Error in 6ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:38:32 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
Completed 500 Internal Server Error in 414ms (ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:38:32 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:38:32 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 428ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:38:32 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 388ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 18ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (9.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (143.1ms)
Completed 200 OK in 173ms (Views: 169.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (2.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:38:33.594823"], ["current_sign_in_at", "2016-01-05 05:38:33.594823"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:38:33.595824"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 30ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 21ms (Views: 18.0ms | ActiveRecord: 2.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:38:33.671852"], ["current_sign_in_at", "2016-01-05 05:38:33.671852"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:38:33.672853"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (11.0ms)
Completed 200 OK in 20ms (Views: 17.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:38:33.749882"], ["current_sign_in_at", "2016-01-05 05:38:33.749882"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:38:33.750882"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:38:33.813906"], ["updated_at", "2016-01-05 05:38:33.813906"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:38:33.845918"], ["current_sign_in_at", "2016-01-05 05:38:33.845918"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:38:33.846918"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:38:33.866926"], ["updated_at", "2016-01-05 05:38:33.866926"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:38:33.898939"], ["current_sign_in_at", "2016-01-05 05:38:33.898939"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:38:33.899939"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:38:33 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:38:33.927949"], ["updated_at", "2016-01-05 05:38:33.927949"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:38:33.930951"], ["updated_at", "2016-01-05 05:38:33.930951"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:38:33.932951"], ["updated_at", "2016-01-05 05:38:33.932951"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:38:33.933951"], ["updated_at", "2016-01-05 05:38:33.933951"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:38:33.938954"], ["updated_at", "2016-01-05 05:38:33.938954"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:38:33.953959"], ["updated_at", "2016-01-05 05:38:33.953959"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:38:33.955960"], ["updated_at", "2016-01-05 05:38:33.955960"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:38:33.956961"], ["updated_at", "2016-01-05 05:38:33.956961"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:38:33.964963"], ["updated_at", "2016-01-05 05:38:33.964963"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (9.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (14.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (109.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (69.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:40:54', '2016-01-05 05:40:54', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:40:54', '2016-01-05 05:40:54', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:40:54', '2016-01-05 05:40:54', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:40:54', '2016-01-05 05:40:54', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:40:54', '2016-01-05 05:40:54', 83783397)[0m
  [1m[35mFixture Delete (19.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$o8cutGfUvN66FHAVnALeieY/XV0CtIsW1kP4XymqLCzARL8xBpcWO', '2016-01-05 05:40:54', '2016-01-05 05:40:54', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:40:54 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (198.1ms)
Completed 200 OK in 660ms (Views: 631.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (2.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:40:55.266243"], ["current_sign_in_at", "2016-01-05 05:40:55.266243"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:40:55.267243"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 29ms (ActiveRecord: 4.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (10.0ms)
Completed 200 OK in 52ms (Views: 50.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 19ms (Views: 17.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:40:55.415299"], ["updated_at", "2016-01-05 05:40:55.415299"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 17ms (Views: 15.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 13ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:40:55.468319"], ["current_sign_in_at", "2016-01-05 05:40:55.468319"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:40:55.469320"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 13ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:40:55.511334"], ["current_sign_in_at", "2016-01-05 05:40:55.511334"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:40:55.512335"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (40.0ms)
Completed 200 OK in 42ms (Views: 41.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 6ms (Views: 4.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:40:55.622377"], ["current_sign_in_at", "2016-01-05 05:40:55.622377"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:40:55.623377"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:40:55.669394"], ["current_sign_in_at", "2016-01-05 05:40:55.669394"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:40:55.670395"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 10ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:40:55.692404"], ["updated_at", "2016-01-05 05:40:55.692404"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 05:40:55.723415"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:40:55.725416"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:40:55.731418"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:40:55.734419"], ["updated_at", "2016-01-05 05:40:55.734419"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:40:55.736420"], ["updated_at", "2016-01-05 05:40:55.736420"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:40:55.750426"], ["updated_at", "2016-01-05 05:40:55.750426"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:40:55.752426"], ["updated_at", "2016-01-05 05:40:55.752426"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:40:55.754427"], ["updated_at", "2016-01-05 05:40:55.754427"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:40:55.760429"], ["updated_at", "2016-01-05 05:40:55.760429"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:40:55.765431"], ["updated_at", "2016-01-05 05:40:55.765431"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:40:55.767432"], ["updated_at", "2016-01-05 05:40:55.767432"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:40:55.771434"], ["updated_at", "2016-01-05 05:40:55.771434"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 500 Internal Server Error in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:40:55 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
Completed 500 Internal Server Error in 345ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:40:56 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 361ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:40:56 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 273ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:40:56 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (11.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (6.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (12.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:44:41', '2016-01-05 05:44:41', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:44:41', '2016-01-05 05:44:41', 459292723)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:44:41', '2016-01-05 05:44:41', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:44:41', '2016-01-05 05:44:41', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:44:41', '2016-01-05 05:44:41', 83783397)[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$RiJ/8q4/uqS7IKez9MDW3u6I25BvgEWXVtSgOgJQbil.SA8LXQbCO', '2016-01-05 05:44:41', '2016-01-05 05:44:41', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:44:41.706788"], ["updated_at", "2016-01-05 05:44:41.706788"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:44:41.710790"], ["updated_at", "2016-01-05 05:44:41.710790"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:44:41.711791"], ["updated_at", "2016-01-05 05:44:41.711791"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (5.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:44:41.727796"], ["updated_at", "2016-01-05 05:44:41.727796"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:44:41.729799"], ["updated_at", "2016-01-05 05:44:41.729799"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:44:41.731799"], ["updated_at", "2016-01-05 05:44:41.731799"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:44:41.736800"], ["updated_at", "2016-01-05 05:44:41.736800"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:44:41.738801"], ["updated_at", "2016-01-05 05:44:41.738801"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:44:41.781818"], ["updated_at", "2016-01-05 05:44:41.781818"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:44:41 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 40ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:44:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (9.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (262.1ms)
Completed 200 OK in 1065ms (Views: 1060.8ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:44:43.070745"], ["current_sign_in_at", "2016-01-05 05:44:43.070745"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:44:43.071745"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 40ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 59ms (Views: 57.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 18ms (Views: 16.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 6ms (Views: 2.0ms | ActiveRecord: 3.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:44:43.228805"], ["current_sign_in_at", "2016-01-05 05:44:43.228805"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:44:43.229805"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 41ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:44:43.287827"], ["updated_at", "2016-01-05 05:44:43.287827"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 6ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (5.0ms)
Completed 200 OK in 16ms (Views: 14.0ms | ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:44:43.333844"], ["current_sign_in_at", "2016-01-05 05:44:43.333844"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:44:43.334845"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:44:43.422878"], ["current_sign_in_at", "2016-01-05 05:44:43.422878"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:44:43.423878"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:44:43.463894"], ["current_sign_in_at", "2016-01-05 05:44:43.463894"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:44:43.464894"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:44:43.482901"], ["updated_at", "2016-01-05 05:44:43.482901"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 3ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 05:44:43.497906"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:44:43.499907"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:44:43.504909"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:44:43 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 459ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:44:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 270ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:44:44 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:44:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
Completed 500 Internal Server Error in 280ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:44:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 500 Internal Server Error in 6ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (5.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (16.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (18.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:47:03', '2016-01-05 05:47:03', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:47:03', '2016-01-05 05:47:03', 459292723)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:47:03', '2016-01-05 05:47:03', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:47:03', '2016-01-05 05:47:03', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:47:03', '2016-01-05 05:47:03', 83783397)[0m
  [1m[35mFixture Delete (17.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (14.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$NLIBfUT4E0.5mvMpM/f.zO3SOFkVhiKC.cXkyBndcAt8HuPgcmJjy', '2016-01-05 05:47:03', '2016-01-05 05:47:03', 830138774)[0m
  [1m[35m (4.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 05:47:03.774463"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:47:03.778465"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:47:03.782467"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:47:03 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (2.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (14.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 738ms (Views: 635.2ms | ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:47:04 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 358ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:47:04 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
Completed 500 Internal Server Error in 272ms (ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 500 Internal Server Error in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 274ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:47:05.592176"], ["updated_at", "2016-01-05 05:47:05.592176"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:47:05.595177"], ["updated_at", "2016-01-05 05:47:05.595177"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:47:05.596177"], ["updated_at", "2016-01-05 05:47:05.596177"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:47:05.600179"], ["updated_at", "2016-01-05 05:47:05.600179"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:47:05.603180"], ["updated_at", "2016-01-05 05:47:05.603180"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:47:05.613184"], ["updated_at", "2016-01-05 05:47:05.613184"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:47:05.617185"], ["updated_at", "2016-01-05 05:47:05.617185"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:47:05.618194"], ["updated_at", "2016-01-05 05:47:05.618194"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:47:05.620186"], ["updated_at", "2016-01-05 05:47:05.620186"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 15ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (10.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (154.1ms)
Completed 200 OK in 184ms (Views: 180.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:47:05.898291"], ["current_sign_in_at", "2016-01-05 05:47:05.898291"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:47:05.899292"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 41ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 18ms (Views: 16.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:47:05.984324"], ["current_sign_in_at", "2016-01-05 05:47:05.984324"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:47:05.985325"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:47:05 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 16ms (Views: 14.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (45.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (48.0ms)
Completed 200 OK in 52ms (Views: 51.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:47:06.077359"], ["current_sign_in_at", "2016-01-05 05:47:06.077359"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:47:06.078360"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (5.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:47:06.150387"], ["current_sign_in_at", "2016-01-05 05:47:06.150387"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:47:06.151387"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:47:06.172395"], ["updated_at", "2016-01-05 05:47:06.172395"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 3ms (ActiveRecord: 3.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:47:06.211410"], ["current_sign_in_at", "2016-01-05 05:47:06.211410"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:47:06.212411"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:47:06.233418"], ["updated_at", "2016-01-05 05:47:06.233418"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:47:06 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (15.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (98.1ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (7.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (10.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (12.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:50:42', '2016-01-05 05:50:42', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:50:42', '2016-01-05 05:50:42', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:50:42', '2016-01-05 05:50:42', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:50:42', '2016-01-05 05:50:42', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:50:42', '2016-01-05 05:50:42', 83783397)[0m
  [1m[35mFixture Delete (16.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$pzHyHVewLHXonIVSCETs4OiYS9uTpVNS9D8uHQoO8yO2QSBcNErmW', '2016-01-05 05:50:42', '2016-01-05 05:50:42', 830138774)[0m
  [1m[35m (7.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:50:42.837663"], ["updated_at", "2016-01-05 05:50:42.837663"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:50:42.879679"], ["updated_at", "2016-01-05 05:50:42.879679"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:50:42.883680"], ["updated_at", "2016-01-05 05:50:42.883680"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:50:42.930698"], ["updated_at", "2016-01-05 05:50:42.930698"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:50:42.932699"], ["updated_at", "2016-01-05 05:50:42.932699"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:50:42.934699"], ["updated_at", "2016-01-05 05:50:42.934699"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:50:42.938701"], ["updated_at", "2016-01-05 05:50:42.938701"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:50:42.939702"], ["updated_at", "2016-01-05 05:50:42.939702"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:50:42.941702"], ["updated_at", "2016-01-05 05:50:42.941702"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:50:42 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (128.0ms)
Completed 200 OK in 535ms (Views: 506.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:50:43.581944"], ["current_sign_in_at", "2016-01-05 05:50:43.581944"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:50:43.582945"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 35ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 43ms (Views: 41.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 51ms (Views: 47.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 13ms (Views: 11.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:50:43.790023"], ["current_sign_in_at", "2016-01-05 05:50:43.790023"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:50:43.791023"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:50:43.812032"], ["updated_at", "2016-01-05 05:50:43.812032"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:50:43.881058"], ["current_sign_in_at", "2016-01-05 05:50:43.881058"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:50:43.882058"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (9.0ms)
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:50:43.927075"], ["current_sign_in_at", "2016-01-05 05:50:43.927075"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:50:43.928075"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:50:43.985097"], ["current_sign_in_at", "2016-01-05 05:50:43.985097"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:50:43.986097"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:50:43 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:50:44 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:50:44.006105"], ["updated_at", "2016-01-05 05:50:44.006105"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:50:44 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 05:50:44.021111"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:50:44.023112"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:50:44.028113"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:50:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:50:44 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:50:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", nil]]
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:50:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:50:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 406ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:50:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:50:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 289ms (ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:50:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
Completed 500 Internal Server Error in 355ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (4.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (75.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (65.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:52:54', '2016-01-05 05:52:54', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:52:54', '2016-01-05 05:52:54', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:52:54', '2016-01-05 05:52:54', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:52:54', '2016-01-05 05:52:54', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:52:54', '2016-01-05 05:52:54', 83783397)[0m
  [1m[35mFixture Delete (19.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (8.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$TWjo0KMrOTR24fgdT0LFZumixeSu7OPDdAQHstkQdbvPiSX4PWr72', '2016-01-05 05:52:54', '2016-01-05 05:52:54', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:52:54 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (201.1ms)
Completed 200 OK in 638ms (Views: 612.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:52:55.253170"], ["current_sign_in_at", "2016-01-05 05:52:55.253170"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:52:55.255170"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 32ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (10.0ms)
Completed 200 OK in 56ms (Views: 54.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 23ms (Views: 18.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:52:55.428236"], ["current_sign_in_at", "2016-01-05 05:52:55.428236"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:52:55.429236"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 13ms (Views: 11.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:52:55.459247"], ["updated_at", "2016-01-05 05:52:55.459247"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:52:55.495261"], ["current_sign_in_at", "2016-01-05 05:52:55.495261"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:52:55.496261"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (38.0ms)
Completed 200 OK in 41ms (Views: 38.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:52:55.554283"], ["updated_at", "2016-01-05 05:52:55.554283"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:52:55.587296"], ["current_sign_in_at", "2016-01-05 05:52:55.587296"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:52:55.588296"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:52:55.657322"], ["current_sign_in_at", "2016-01-05 05:52:55.657322"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:52:55.658323"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 7ms (Views: 6.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:52:55 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 375ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:52:56 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 330ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:52:56 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", nil]]
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:52:56 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
Completed 500 Internal Server Error in 340ms (ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:52:56 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:52:56.832768"], ["updated_at", "2016-01-05 05:52:56.832768"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:52:56.834768"], ["updated_at", "2016-01-05 05:52:56.834768"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:52:56.836769"], ["updated_at", "2016-01-05 05:52:56.836769"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:52:56.840770"], ["updated_at", "2016-01-05 05:52:56.840770"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:52:56.842771"], ["updated_at", "2016-01-05 05:52:56.842771"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:52:56.844772"], ["updated_at", "2016-01-05 05:52:56.844772"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:52:56.850774"], ["updated_at", "2016-01-05 05:52:56.850774"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:52:56.856776"], ["updated_at", "2016-01-05 05:52:56.856776"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:52:56.862778"], ["updated_at", "2016-01-05 05:52:56.862778"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-05 05:52:56.867781"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:52:56.870782"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:52:56.874783"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (22.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (8.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (17.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (14.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:56:20', '2016-01-05 05:56:20', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:56:20', '2016-01-05 05:56:20', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:56:20', '2016-01-05 05:56:20', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:56:20', '2016-01-05 05:56:20', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:56:20', '2016-01-05 05:56:20', 83783397)[0m
  [1m[35mFixture Delete (19.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$NE/2LTqqPMY9v9YhcEE/Ae/KXhVqMNrm7yxJOEqxqrIyo4Y7wk9Hu', '2016-01-05 05:56:21', '2016-01-05 05:56:21', 830138774)[0m
  [1m[35m (7.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 05:56:21.093328"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:56:21.097330"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:56:21.102333"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:56:21 +0700
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:56:21 +0700
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:56:21 +0700
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:56:21 +0700
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:56:21 +0700
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:56:21 +0700
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:56:21 +0700
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:56:21 +0700
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:56:21.230381"], ["updated_at", "2016-01-05 05:56:21.230381"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:56:21.234382"], ["updated_at", "2016-01-05 05:56:21.234382"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:56:21.324416"], ["updated_at", "2016-01-05 05:56:21.324416"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:56:21.326417"], ["updated_at", "2016-01-05 05:56:21.326417"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:56:21.327417"], ["updated_at", "2016-01-05 05:56:21.327417"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:56:21.333420"], ["updated_at", "2016-01-05 05:56:21.333420"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:56:21.336421"], ["updated_at", "2016-01-05 05:56:21.336421"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:56:21.340423"], ["updated_at", "2016-01-05 05:56:21.340423"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (2.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:56:21.347425"], ["updated_at", "2016-01-05 05:56:21.347425"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:56:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (159.1ms)
Completed 200 OK in 654ms (Views: 615.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:56:22.066697"], ["current_sign_in_at", "2016-01-05 05:56:22.066697"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:56:22.068698"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 32ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:56:22.122718"], ["current_sign_in_at", "2016-01-05 05:56:22.122718"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:56:22.123718"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (41.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (44.0ms)
Completed 200 OK in 47ms (Views: 46.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:56:22.190744"], ["current_sign_in_at", "2016-01-05 05:56:22.190744"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:56:22.192745"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:56:22.225757"], ["current_sign_in_at", "2016-01-05 05:56:22.225757"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:56:22.226758"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:56:22.303786"], ["current_sign_in_at", "2016-01-05 05:56:22.303786"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:56:22.304787"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:56:22 +0700
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (4.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (10.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (11.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 05:57:18', '2016-01-05 05:57:18', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 05:57:18', '2016-01-05 05:57:18', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 05:57:18', '2016-01-05 05:57:18', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 05:57:18', '2016-01-05 05:57:18', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 05:57:18', '2016-01-05 05:57:18', 83783397)[0m
  [1m[35mFixture Delete (9.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (7.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$eQOyO8Un0LjJ2HFO2UI8TuvJSgnQmtHafNOa0g356TCycHNpkUcTG', '2016-01-05 05:57:18', '2016-01-05 05:57:18', 830138774)[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:57:18 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
Completed 500 Internal Server Error in 441ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:57:19 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (13.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 533ms (Views: 460.2ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:57:19 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:57:19 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:57:20 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 413ms (ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 12:57:20 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 8ms (Views: 5.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:57:20 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 326ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 12:57:20 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", nil]]
Completed 500 Internal Server Error in 1ms (ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:57:20 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (139.1ms)
Completed 200 OK in 171ms (Views: 163.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:57:20 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:57:21.049278"], ["current_sign_in_at", "2016-01-05 05:57:21.049278"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:57:21.050278"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 75ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 18ms (Views: 15.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:57:21.151316"], ["current_sign_in_at", "2016-01-05 05:57:21.151316"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:57:21.152317"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 22ms (Views: 20.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:57:21.208338"], ["current_sign_in_at", "2016-01-05 05:57:21.208338"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:57:21.209339"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 05:57:21.274363"], ["current_sign_in_at", "2016-01-05 05:57:21.274363"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:57:21.275364"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:57:21.295371"], ["updated_at", "2016-01-05 05:57:21.295371"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 05:57:21.330384"], ["current_sign_in_at", "2016-01-05 05:57:21.330384"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 05:57:21.331385"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:57:21.352393"], ["updated_at", "2016-01-05 05:57:21.352393"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 12:57:21 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-05 05:57:21.379403"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 05:57:21.381404"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 05:57:21.388406"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:57:21.403412"], ["updated_at", "2016-01-05 05:57:21.403412"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:57:21.405413"], ["updated_at", "2016-01-05 05:57:21.405413"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:57:21.406413"], ["updated_at", "2016-01-05 05:57:21.406413"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:57:21.410415"], ["updated_at", "2016-01-05 05:57:21.410415"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:57:21.418418"], ["updated_at", "2016-01-05 05:57:21.418418"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:57:21.423420"], ["updated_at", "2016-01-05 05:57:21.423420"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:57:21.426421"], ["updated_at", "2016-01-05 05:57:21.426421"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:57:21.428422"], ["updated_at", "2016-01-05 05:57:21.428422"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 05:57:21.429422"], ["updated_at", "2016-01-05 05:57:21.429422"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (13.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (13.1ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (12.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 07:09:38', '2016-01-05 07:09:38', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 07:09:38', '2016-01-05 07:09:38', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 07:09:38', '2016-01-05 07:09:38', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 07:09:38', '2016-01-05 07:09:38', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 07:09:38', '2016-01-05 07:09:38', 83783397)[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$nLloagl1kXc81SDb1lWUZOsU7cEfvO0pArePPWEf9sGuHcEDIWn..', '2016-01-05 07:09:38', '2016-01-05 07:09:38', 830138774)[0m
  [1m[35m (7.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:09:38 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 562ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:09:39 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 318ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:09:39 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (3.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (18.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 687ms (Views: 533.0ms | ActiveRecord: 3.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:09:40 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (2.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 14:09:40 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (7.0ms)
Completed 200 OK in 11ms (Views: 8.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:09:40 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:09:40 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:09:40 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 330ms (ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (45.1ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (50.1ms)
  Rendered devise/sessions/new.html.erb within layouts/application (184.4ms)
Completed 200 OK in 238ms (Views: 213.4ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (2.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:09:41.522899"], ["current_sign_in_at", "2016-01-05 07:09:41.522899"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:09:41.523899"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 34ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 17ms (Views: 15.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:09:41.635111"], ["current_sign_in_at", "2016-01-05 07:09:41.635111"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:09:41.636113"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 16ms (Views: 14.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:09:41.689214"], ["current_sign_in_at", "2016-01-05 07:09:41.689214"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:09:41.690217"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 11ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 07:09:41.769368"], ["current_sign_in_at", "2016-01-05 07:09:41.769368"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:09:41.770370"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:09:41.792411"], ["updated_at", "2016-01-05 07:09:41.792411"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:09:41.824472"], ["current_sign_in_at", "2016-01-05 07:09:41.824472"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:09:41.825475"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:09:41.846514"], ["updated_at", "2016-01-05 07:09:41.846514"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:09:41 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:09:41.860541"], ["updated_at", "2016-01-05 07:09:41.860541"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:09:41.864549"], ["updated_at", "2016-01-05 07:09:41.864549"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:09:41.869558"], ["updated_at", "2016-01-05 07:09:41.869558"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:09:41.873566"], ["updated_at", "2016-01-05 07:09:41.873566"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:09:41.875570"], ["updated_at", "2016-01-05 07:09:41.875570"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:09:41.877573"], ["updated_at", "2016-01-05 07:09:41.877573"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:09:41.892602"], ["updated_at", "2016-01-05 07:09:41.892602"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:09:41.893604"], ["updated_at", "2016-01-05 07:09:41.893604"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:09:41.896609"], ["updated_at", "2016-01-05 07:09:41.896609"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-05 07:09:41.908632"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 07:09:41.910637"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 07:09:41.915646"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (6.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (12.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 07:22:07', '2016-01-05 07:22:07', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 07:22:07', '2016-01-05 07:22:07', 459292723)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 07:22:07', '2016-01-05 07:22:07', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 07:22:07', '2016-01-05 07:22:07', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 07:22:07', '2016-01-05 07:22:07', 83783397)[0m
  [1m[35mFixture Delete (16.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (8.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$LiDqL4Z8jEqb/J17i0nWmuLTDgvGG1uqMWWkDe1SzFOUgGJdm0oyy', '2016-01-05 07:22:07', '2016-01-05 07:22:07', 830138774)[0m
  [1m[35m (7.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 07:22:07.419455"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 07:22:07.424458"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 07:22:07.429460"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:22:07.452470"], ["updated_at", "2016-01-05 07:22:07.452470"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:22:07.464476"], ["updated_at", "2016-01-05 07:22:07.464476"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:22:07.465476"], ["updated_at", "2016-01-05 07:22:07.465476"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:22:07.466476"], ["updated_at", "2016-01-05 07:22:07.466476"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:22:07.510496"], ["updated_at", "2016-01-05 07:22:07.510496"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:22:07.512497"], ["updated_at", "2016-01-05 07:22:07.512497"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:22:07.518500"], ["updated_at", "2016-01-05 07:22:07.518500"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:22:07.520501"], ["updated_at", "2016-01-05 07:22:07.520501"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:22:07.521501"], ["updated_at", "2016-01-05 07:22:07.521501"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:22:07 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (135.1ms)
Completed 200 OK in 757ms (Views: 726.4ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (4.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 07:22:08.389943"], ["current_sign_in_at", "2016-01-05 07:22:08.389943"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:22:08.390943"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 65ms (ActiveRecord: 4.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 77ms (Views: 77.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 20ms (Views: 14.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:22:08.620067"], ["updated_at", "2016-01-05 07:22:08.620067"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 16ms (Views: 15.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (4.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 07:22:08.669090"], ["current_sign_in_at", "2016-01-05 07:22:08.669090"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:22:08.670090"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 43ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 07:22:08.745123"], ["current_sign_in_at", "2016-01-05 07:22:08.745123"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:22:08.746124"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:22:08.803160"], ["current_sign_in_at", "2016-01-05 07:22:08.803160"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:22:08.804160"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:22:08.823170"], ["updated_at", "2016-01-05 07:22:08.823170"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 07:22:08.858184"], ["current_sign_in_at", "2016-01-05 07:22:08.858184"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:22:08.859184"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:22:08 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:22:09 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<Omise::Token:0x891dc50>", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 358ms (ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:22:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<Omise::Token:0x89dd638>", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:22:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"#<Omise::Token:0x8a87780>", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:22:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"#<Omise::Token:0x8b29a98>", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 316ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:22:12 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"#<Omise::Token:0x8c1ef88>", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 14:22:12 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:22:12 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"#<Omise::Token:0x8cf1c90>", "charity"=>"random"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
Completed 500 Internal Server Error in 316ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (20.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (9.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (18.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (15.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 07:36:59', '2016-01-05 07:36:59', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 07:36:59', '2016-01-05 07:36:59', 459292723)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 07:36:59', '2016-01-05 07:36:59', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 07:36:59', '2016-01-05 07:36:59', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 07:36:59', '2016-01-05 07:36:59', 83783397)[0m
  [1m[35mFixture Delete (16.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$RqBapCsV5n0olz0cJwyeNOA4LdiC574G.lwW9hLXLdeuWlX06hjvS', '2016-01-05 07:36:59', '2016-01-05 07:36:59', 830138774)[0m
  [1m[35m (7.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:36:59 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (26.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (265.1ms)
Completed 200 OK in 1618ms (Views: 1581.5ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 07:37:01.464712"], ["current_sign_in_at", "2016-01-05 07:37:01.464712"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:37:01.465712"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 44ms (ActiveRecord: 4.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (10.0ms)
Completed 200 OK in 69ms (Views: 66.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 27ms (Views: 23.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 18ms (Views: 16.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:37:01.727813"], ["current_sign_in_at", "2016-01-05 07:37:01.727813"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:37:01.728814"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (51.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (58.0ms)
Completed 200 OK in 61ms (Views: 60.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:37:01.829852"], ["current_sign_in_at", "2016-01-05 07:37:01.829852"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:37:01.830852"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 6ms (Views: 2.0ms | ActiveRecord: 3.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:37:01.879871"], ["current_sign_in_at", "2016-01-05 07:37:01.879871"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:37:01.880871"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:37:01.901879"], ["updated_at", "2016-01-05 07:37:01.901879"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 07:37:01.934893"], ["current_sign_in_at", "2016-01-05 07:37:01.934893"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:37:01.935894"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:37:01.954900"], ["updated_at", "2016-01-05 07:37:01.954900"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:37:01 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:37:01.971907"], ["updated_at", "2016-01-05 07:37:01.971907"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:37:01.976909"], ["updated_at", "2016-01-05 07:37:01.976909"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:37:01.978909"], ["updated_at", "2016-01-05 07:37:01.978909"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:37:01.980911"], ["updated_at", "2016-01-05 07:37:01.980911"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:37:01.987913"], ["updated_at", "2016-01-05 07:37:01.987913"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:37:01.999918"], ["updated_at", "2016-01-05 07:37:01.999918"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:37:02.007921"], ["updated_at", "2016-01-05 07:37:02.007921"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:37:02.009922"], ["updated_at", "2016-01-05 07:37:02.009922"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:37:02.011922"], ["updated_at", "2016-01-05 07:37:02.011922"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 07:37:02.017924"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 07:37:02.019925"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 07:37:02.023927"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:37:02 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"AAAAA", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 11ms (Views: 8.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:37:02 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"AAAAA", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:37:02 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:37:02 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"AAAAA", "charity"=>"random"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 992ms (ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:37:03 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"AAAAA", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 14:37:03 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:37:03 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"AAAAA", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 312ms (ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:37:03 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"AAAAA", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 272ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[36mActiveRecord::SchemaMigration Load (21.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (10.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (15.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 07:48:02', '2016-01-05 07:48:02', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 07:48:02', '2016-01-05 07:48:02', 459292723)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 07:48:02', '2016-01-05 07:48:02', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 07:48:02', '2016-01-05 07:48:02', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 07:48:02', '2016-01-05 07:48:02', 83783397)[0m
  [1m[35mFixture Delete (18.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (11.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$TGz7D0tT5DYnN6L.TiLseu/mpmvcQ0ZL8C8mwo9ef/pkDhcyaXI6S', '2016-01-05 07:48:02', '2016-01-05 07:48:02', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:48:02.182923"], ["updated_at", "2016-01-05 07:48:02.182923"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:48:02.189926"], ["updated_at", "2016-01-05 07:48:02.189926"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:48:02.191926"], ["updated_at", "2016-01-05 07:48:02.191926"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:48:02.193928"], ["updated_at", "2016-01-05 07:48:02.193928"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (3.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (15.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:48:02.274959"], ["updated_at", "2016-01-05 07:48:02.274959"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:48:02.276960"], ["updated_at", "2016-01-05 07:48:02.276960"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:48:02.277960"], ["updated_at", "2016-01-05 07:48:02.277960"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:48:02.281962"], ["updated_at", "2016-01-05 07:48:02.281962"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:48:02.284963"], ["updated_at", "2016-01-05 07:48:02.284963"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:48:02 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"goodbye", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (13.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 742ms (Views: 685.3ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:48:03 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"goodbye", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:48:03 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"goodbye", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:48:03 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"goodbye", "charity"=>"random"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 424ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:48:03 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:48:03 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"goodbye", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 273ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:48:03 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"goodbye", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 283ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 14:48:04 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 7ms (Views: 7.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (36.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:48:04 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (9.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (178.1ms)
Completed 200 OK in 419ms (Views: 376.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (4.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:48:05.656280"], ["current_sign_in_at", "2016-01-05 07:48:05.656280"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:48:05.657280"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 37ms (ActiveRecord: 6.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 17ms (Views: 15.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:48:05.738313"], ["updated_at", "2016-01-05 07:48:05.738313"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (5.0ms)
Completed 200 OK in 19ms (Views: 18.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:48:05.786332"], ["current_sign_in_at", "2016-01-05 07:48:05.786332"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:48:05.787332"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:48:05.824346"], ["current_sign_in_at", "2016-01-05 07:48:05.824346"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:48:05.825346"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 12ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 07:48:05.897375"], ["current_sign_in_at", "2016-01-05 07:48:05.897375"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:48:05.899376"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 6ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (5.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 07:48:05.963400"], ["current_sign_in_at", "2016-01-05 07:48:05.963400"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:48:05.964400"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:48:05.985409"], ["updated_at", "2016-01-05 07:48:05.985409"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:48:05 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-05 07:48:06.003416"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 07:48:06.005418"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 07:48:06.010418"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (98.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (4.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (12.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 07:50:21', '2016-01-05 07:50:21', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 07:50:21', '2016-01-05 07:50:21', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 07:50:21', '2016-01-05 07:50:21', 103210531)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 07:50:21', '2016-01-05 07:50:21', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 07:50:21', '2016-01-05 07:50:21', 83783397)[0m
  [1m[35mFixture Delete (19.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$Hp6pqNhfYU9EFi29KzDubeHGWI4M80iLvKBErKA2aCCBLUZ.8Sj9.', '2016-01-05 07:50:21', '2016-01-05 07:50:21', 830138774)[0m
  [1m[35m (8.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (6.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:50:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (209.1ms)
Completed 200 OK in 724ms (Views: 656.3ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 07:50:22.239288"], ["current_sign_in_at", "2016-01-05 07:50:22.239288"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:50:22.240289"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 29ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (9.0ms)
Completed 200 OK in 53ms (Views: 51.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 20ms (Views: 18.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 07:50:22.413356"], ["current_sign_in_at", "2016-01-05 07:50:22.413356"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:50:22.414356"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 8ms (Views: 5.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 19ms (Views: 17.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 07:50:22.470377"], ["current_sign_in_at", "2016-01-05 07:50:22.470377"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:50:22.471378"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:50:22.527400"], ["updated_at", "2016-01-05 07:50:22.527400"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:50:22.571416"], ["current_sign_in_at", "2016-01-05 07:50:22.571416"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:50:22.572416"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:50:22.592425"], ["updated_at", "2016-01-05 07:50:22.592425"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 07:50:22.622436"], ["current_sign_in_at", "2016-01-05 07:50:22.622436"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 07:50:22.623437"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 14:50:22 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (4.0ms)
Completed 200 OK in 7ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 07:50:22.670454"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 07:50:22.680459"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 07:50:22.682459"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:50:22.689462"], ["updated_at", "2016-01-05 07:50:22.689462"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:50:22.691463"], ["updated_at", "2016-01-05 07:50:22.691463"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:50:22.692463"], ["updated_at", "2016-01-05 07:50:22.692463"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:50:22.697465"], ["updated_at", "2016-01-05 07:50:22.697465"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:50:22.705468"], ["updated_at", "2016-01-05 07:50:22.705468"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:50:22.707468"], ["updated_at", "2016-01-05 07:50:22.707468"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:50:22.717473"], ["updated_at", "2016-01-05 07:50:22.717473"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:50:22.719474"], ["updated_at", "2016-01-05 07:50:22.719474"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 07:50:22.720474"], ["updated_at", "2016-01-05 07:50:22.720474"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 14:50:25 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 14:50:25 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 11ms (Views: 8.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (15.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (9.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (12.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (13.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 08:14:24', '2016-01-05 08:14:24', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 08:14:24', '2016-01-05 08:14:24', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 08:14:24', '2016-01-05 08:14:24', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 08:14:24', '2016-01-05 08:14:24', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 08:14:24', '2016-01-05 08:14:24', 83783397)[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$NCFNL8j1GHSzjEr8MKcmT.h6QumPzmJyzoQQGrYDfiTMAmmkQ/lGq', '2016-01-05 08:14:24', '2016-01-05 08:14:24', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:14:24.426330"], ["updated_at", "2016-01-05 08:14:24.426330"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:14:24.433333"], ["updated_at", "2016-01-05 08:14:24.433333"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:14:24.437335"], ["updated_at", "2016-01-05 08:14:24.437335"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:14:24.445337"], ["updated_at", "2016-01-05 08:14:24.445337"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:14:24.447338"], ["updated_at", "2016-01-05 08:14:24.447338"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:14:24.448339"], ["updated_at", "2016-01-05 08:14:24.448339"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:14:24.483353"], ["updated_at", "2016-01-05 08:14:24.483353"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:14:24.485353"], ["updated_at", "2016-01-05 08:14:24.485353"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:14:24.487354"], ["updated_at", "2016-01-05 08:14:24.487354"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (3.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:14:24 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (154.1ms)
Completed 200 OK in 651ms (Views: 615.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:14:25 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (21.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:14:25.302672"], ["current_sign_in_at", "2016-01-05 08:14:25.302672"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:14:25.303680"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 201ms (ActiveRecord: 22.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:14:25 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 318ms (Views: 298.3ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (11.0ms)
Completed 200 OK in 24ms (Views: 21.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:14:26.259617"], ["updated_at", "2016-01-05 08:14:26.259617"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (27.0ms)
Completed 200 OK in 293ms (Views: 290.7ms | ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (2.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 12ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:14:26.591322"], ["current_sign_in_at", "2016-01-05 08:14:26.591322"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:14:26.592323"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 57ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 08:14:26.762444"], ["current_sign_in_at", "2016-01-05 08:14:26.762444"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:14:26.763444"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 08:14:26.814464"], ["current_sign_in_at", "2016-01-05 08:14:26.814464"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:14:26.815465"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 08:14:26.861482"], ["current_sign_in_at", "2016-01-05 08:14:26.861482"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:14:26.862483"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:14:26.886492"], ["updated_at", "2016-01-05 08:14:26.886492"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 08:14:26.902499"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 08:14:26.904500"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 08:14:26.908502"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 15:14:26 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:14:27 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"72065160", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 426ms (ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:14:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"72625620", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 408ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:14:29 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:14:29 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"73207284", "charity"=>"random"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
Completed 500 Internal Server Error in 1591ms (ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:14:31 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 6ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (289.2ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (6.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (9.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (13.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 08:15:43', '2016-01-05 08:15:43', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 08:15:43', '2016-01-05 08:15:43', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 08:15:43', '2016-01-05 08:15:43', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 08:15:43', '2016-01-05 08:15:43', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 08:15:43', '2016-01-05 08:15:43', 83783397)[0m
  [1m[35mFixture Delete (16.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (8.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$SHkKBeaow/E6q6PAQ1j1S.IfjIxVOwqXH8WZ5yaYhCcIzdUNWD2wq', '2016-01-05 08:15:43', '2016-01-05 08:15:43', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:15:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l3yl70kv1dec0bn91", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 08:15:45.158922"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 649ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:15:45 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (3.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (80.0ms)
Completed 200 OK in 535ms (Views: 530.2ms | ActiveRecord: 3.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:15:45 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 11ms (Views: 8.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:15:45 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:15:45 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 15:15:45 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:15:45 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (6.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:15:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52l3ylmiffhsg9ziz2n", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 99900], ["updated_at", "2016-01-05 08:15:47.023707"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 528ms (ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:15:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l3yltr23cihm7ktil", "charity"=>"random"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 08:15:47.956148"], ["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 497ms (ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:15:47.977156"], ["updated_at", "2016-01-05 08:15:47.977156"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:15:47.981158"], ["updated_at", "2016-01-05 08:15:47.981158"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:15:47.992163"], ["updated_at", "2016-01-05 08:15:47.992163"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:15:47.993164"], ["updated_at", "2016-01-05 08:15:47.993164"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:15:47.995164"], ["updated_at", "2016-01-05 08:15:47.995164"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:15:48.000166"], ["updated_at", "2016-01-05 08:15:48.000166"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:15:48.007169"], ["updated_at", "2016-01-05 08:15:48.007169"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:15:48.009169"], ["updated_at", "2016-01-05 08:15:48.009169"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:15:48.011170"], ["updated_at", "2016-01-05 08:15:48.011170"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (9.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (164.1ms)
Completed 200 OK in 199ms (Views: 192.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 08:15:48.263268"], ["current_sign_in_at", "2016-01-05 08:15:48.263268"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:15:48.264269"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 28ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 26ms (Views: 24.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 13ms (Views: 11.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:15:48.404324"], ["current_sign_in_at", "2016-01-05 08:15:48.404324"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:15:48.405324"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:15:48.443339"], ["current_sign_in_at", "2016-01-05 08:15:48.443339"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:15:48.444339"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:15:48.494359"], ["current_sign_in_at", "2016-01-05 08:15:48.494359"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:15:48.495359"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:15:48.516368"], ["updated_at", "2016-01-05 08:15:48.516368"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 08:15:48.551381"], ["current_sign_in_at", "2016-01-05 08:15:48.551381"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:15:48.552382"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:15:48.572389"], ["updated_at", "2016-01-05 08:15:48.572389"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:15:48 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-05 08:15:48.589396"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 08:15:48.590396"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 08:15:48.595398"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (35.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (6.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (16.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (15.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 08:19:24', '2016-01-05 08:19:24', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 08:19:24', '2016-01-05 08:19:24', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 08:19:24', '2016-01-05 08:19:24', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 08:19:24', '2016-01-05 08:19:24', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 08:19:24', '2016-01-05 08:19:24', 83783397)[0m
  [1m[35mFixture Delete (22.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$PAHKDyTd06g1iDIYFen4nu0J1Dwieeq9tmijQb.iu9dk0GyFLfUm.', '2016-01-05 08:19:25', '2016-01-05 08:19:25', 830138774)[0m
  [1m[35m (10.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:19:25 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 43ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:19:25 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (10.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (188.1ms)
Completed 200 OK in 1013ms (Views: 1008.4ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:19:26 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (20.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (10.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (44.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:19:26.475495"], ["current_sign_in_at", "2016-01-05 08:19:26.475495"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:19:26.486503"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 377ms (ActiveRecord: 74.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:19:26 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (11.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (20.0ms)
Completed 200 OK in 274ms (Views: 147.4ms | ActiveRecord: 11.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (8.0ms)
Completed 200 OK in 36ms (Views: 32.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:19:27.374526"], ["current_sign_in_at", "2016-01-05 08:19:27.374526"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:19:27.375527"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (13.0ms)
Completed 200 OK in 18ms (Views: 15.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:19:27.439551"], ["current_sign_in_at", "2016-01-05 08:19:27.439551"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:19:27.440551"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:19:27.500574"], ["updated_at", "2016-01-05 08:19:27.500574"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 08:19:27.535588"], ["current_sign_in_at", "2016-01-05 08:19:27.535588"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:19:27.536588"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:19:27.630623"], ["current_sign_in_at", "2016-01-05 08:19:27.630623"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:19:27.631624"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:19:27.656634"], ["updated_at", "2016-01-05 08:19:27.656634"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 08:19:27.683644"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 08:19:27.685645"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 08:19:27.690646"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:19:27.696648"], ["updated_at", "2016-01-05 08:19:27.696648"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:19:27.698650"], ["updated_at", "2016-01-05 08:19:27.698650"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:19:27.700650"], ["updated_at", "2016-01-05 08:19:27.700650"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:19:27.702651"], ["updated_at", "2016-01-05 08:19:27.702651"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:19:27.716656"], ["updated_at", "2016-01-05 08:19:27.716656"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:19:27.718657"], ["updated_at", "2016-01-05 08:19:27.718657"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:19:27.720658"], ["updated_at", "2016-01-05 08:19:27.720658"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:19:27.723659"], ["updated_at", "2016-01-05 08:19:27.723659"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:19:27.729661"], ["updated_at", "2016-01-05 08:19:27.729661"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:19:27 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:19:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l3zwixunv4npzlej8", "charity"=>"random"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 08:19:29.182211"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 615ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:19:29 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:19:29 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l3zwrqj6vic2kkt1d", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 08:19:30.223899"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 515ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:19:30 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:19:30 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52l3zwzhqc7er09fogj", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 99900], ["updated_at", "2016-01-05 08:19:31.299308"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 566ms (ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:19:31 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (6.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (10.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (11.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 08:21:19', '2016-01-05 08:21:19', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 08:21:19', '2016-01-05 08:21:19', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 08:21:19', '2016-01-05 08:21:19', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 08:21:19', '2016-01-05 08:21:19', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 08:21:19', '2016-01-05 08:21:19', 83783397)[0m
  [1m[35mFixture Delete (14.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (12.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$NERIcnT/Sw8cslEVdfgYj.JW4Hwh4iPjsvqwGOItxjHsTph0Qs3kK', '2016-01-05 08:21:19', '2016-01-05 08:21:19', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:21:19 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (12.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (536.2ms)
Completed 200 OK in 1471ms (Views: 1289.8ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:21:20 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:21:20.898212"], ["current_sign_in_at", "2016-01-05 08:21:20.898212"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:21:20.899211"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 32ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:21:20 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (11.0ms)
Completed 200 OK in 78ms (Views: 75.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 19ms (Views: 16.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 7ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:21:21.108290"], ["current_sign_in_at", "2016-01-05 08:21:21.108290"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:21:21.109291"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 23ms (Views: 21.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:21:21.172315"], ["current_sign_in_at", "2016-01-05 08:21:21.172315"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:21:21.173315"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:21:21.233338"], ["updated_at", "2016-01-05 08:21:21.233338"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 08:21:21.263349"], ["current_sign_in_at", "2016-01-05 08:21:21.263349"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:21:21.264349"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 08:21:21.523486"], ["current_sign_in_at", "2016-01-05 08:21:21.523486"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 08:21:21.523486"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:21:21.544494"], ["updated_at", "2016-01-05 08:21:21.544494"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:21:21 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:21:22 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52l40klx33ag2tidr6y", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 99900], ["updated_at", "2016-01-05 08:21:23.219271"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 630ms (Views: 3.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:21:23 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 15:21:23 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:21:23 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l40kv1jvys504nbnw", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 08:21:24.383824"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 609ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:21:24 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:21:24 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l40l3vcfhjuu3vqk3", "charity"=>"random"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 08:21:25.612421"], ["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 674ms (Views: 3.0ms | ActiveRecord: 2.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 15:21:25 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-05 08:21:25.640431"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 08:21:25.643432"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 08:21:25.648434"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:21:25.660439"], ["updated_at", "2016-01-05 08:21:25.660439"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:21:25.662439"], ["updated_at", "2016-01-05 08:21:25.662439"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:21:25.664440"], ["updated_at", "2016-01-05 08:21:25.664440"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:21:25.669442"], ["updated_at", "2016-01-05 08:21:25.669442"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:21:25.673443"], ["updated_at", "2016-01-05 08:21:25.673443"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:21:25.679445"], ["updated_at", "2016-01-05 08:21:25.679445"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:21:25.681448"], ["updated_at", "2016-01-05 08:21:25.681448"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:21:25.687449"], ["updated_at", "2016-01-05 08:21:25.687449"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 08:21:25.689450"], ["updated_at", "2016-01-05 08:21:25.689450"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (11.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (5.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (8.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 09:22:51', '2016-01-05 09:22:51', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 09:22:51', '2016-01-05 09:22:51', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 09:22:51', '2016-01-05 09:22:51', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 09:22:51', '2016-01-05 09:22:51', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 09:22:51', '2016-01-05 09:22:51', 83783397)[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (8.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$epbn75Zz6RnlTBU/lh.Nq.81na83/m89VBcDwjeACEfGsrBG1V.nC', '2016-01-05 09:22:51', '2016-01-05 09:22:51', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 09:22:51.925520"], ["updated_at", "2016-01-05 09:22:51.925520"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 09:22:51.929522"], ["updated_at", "2016-01-05 09:22:51.929522"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 09:22:51.931522"], ["updated_at", "2016-01-05 09:22:51.931522"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 09:22:51.944527"], ["updated_at", "2016-01-05 09:22:51.944527"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 09:22:51.946529"], ["updated_at", "2016-01-05 09:22:51.946529"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 09:22:51.948531"], ["updated_at", "2016-01-05 09:22:51.948531"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 09:22:51.952530"], ["updated_at", "2016-01-05 09:22:51.952530"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 09:22:51.955532"], ["updated_at", "2016-01-05 09:22:51.955532"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 09:22:51.961535"], ["updated_at", "2016-01-05 09:22:51.961535"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 16:22:52 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (121.1ms)
Completed 200 OK in 1271ms (Views: 1240.8ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 09:22:53.374492"], ["current_sign_in_at", "2016-01-05 09:22:53.374492"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 09:22:53.375493"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 31ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (8.0ms)
Completed 200 OK in 56ms (Views: 56.1ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 21ms (Views: 18.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 09:22:53.515710"], ["updated_at", "2016-01-05 09:22:53.515710"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 16ms (Views: 13.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 09:22:53.559744"], ["current_sign_in_at", "2016-01-05 09:22:53.559744"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 09:22:53.560745"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 42ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 09:22:53.643778"], ["current_sign_in_at", "2016-01-05 09:22:53.643778"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 09:22:53.644783"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 3ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 09:22:53.719897"], ["current_sign_in_at", "2016-01-05 09:22:53.719897"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 09:22:53.720898"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 09:22:53.757912"], ["current_sign_in_at", "2016-01-05 09:22:53.757912"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 09:22:53.758914"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 7ms (Views: 6.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 09:22:53.782924"], ["updated_at", "2016-01-05 09:22:53.782924"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 16:22:53 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 09:22:53.798964"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 09:22:53.800972"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 09:22:53.805968"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 16:22:54 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l4m8bat3fjf2361ah", "charity"=>"random"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 09:22:54.749719"], ["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 467ms (Views: 4.0ms | ActiveRecord: 2.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 16:22:54 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 16:22:55 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l4m8if21kneuwnit1", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 09:22:55.772753"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 572ms (Views: 5.0ms | ActiveRecord: 3.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 16:22:55 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 7ms (Views: 5.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 16:22:55 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 16:22:56 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52l4m8rpjg29pqorhft", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 1228ms (Views: 6.0ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 16:22:57 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 16:22:57 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (10.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (7.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 11:01:35', '2016-01-05 11:01:35', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 11:01:35', '2016-01-05 11:01:35', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 11:01:35', '2016-01-05 11:01:35', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 11:01:35', '2016-01-05 11:01:35', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 11:01:35', '2016-01-05 11:01:35', 83783397)[0m
  [1m[35mFixture Delete (14.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$0gNMccYLP/qzOodwTgQ8A.qDt4VljJI5Lbmm9OxwLReXf.mF3e6wG', '2016-01-05 11:01:35', '2016-01-05 11:01:35', 830138774)[0m
  [1m[35m (7.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:01:35 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (185.3ms)
Completed 200 OK in 753ms (Views: 726.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 11:01:36.193459"], ["current_sign_in_at", "2016-01-05 11:01:36.193459"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:01:36.194460"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 29ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (10.0ms)
Completed 200 OK in 54ms (Views: 52.1ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 18ms (Views: 16.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 16ms (Views: 14.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 11:01:36.381601"], ["current_sign_in_at", "2016-01-05 11:01:36.381601"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:01:36.382602"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 11:01:36.418616"], ["current_sign_in_at", "2016-01-05 11:01:36.418616"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:01:36.419616"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (37.0ms)
Completed 200 OK in 39ms (Views: 38.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:01:36.478640"], ["updated_at", "2016-01-05 11:01:36.478640"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 11:01:36.512651"], ["current_sign_in_at", "2016-01-05 11:01:36.512651"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:01:36.513650"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 11:01:36.561670"], ["current_sign_in_at", "2016-01-05 11:01:36.561670"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:01:36.562670"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:01:36.580676"], ["updated_at", "2016-01-05 11:01:36.580676"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 3ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:01:36 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:01:37 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52l5kz90yvg1fhxy0o0", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 99900], ["updated_at", "2016-01-05 11:01:37.737323"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 592ms (ActiveRecord: 2.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 18:01:37 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:01:37 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 11ms (Views: 11.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:01:38 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l5kzhcnq4qpajjhxk", "charity"=>"random"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 11:01:38.876590"], ["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 651ms (ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:01:38 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 500 Internal Server Error in 324ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:01:39 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l5kzsqohmvcynyr86", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 11:01:40.294499"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 571ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:01:40 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 7ms (Views: 6.0ms | ActiveRecord: 1.0ms)
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:01:40 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (5.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:01:40 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 500 Internal Server Error in 238ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 11:01:40.588492"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 11:01:40.591492"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 11:01:40.599497"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:01:40.605498"], ["updated_at", "2016-01-05 11:01:40.605498"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:01:40.608498"], ["updated_at", "2016-01-05 11:01:40.608498"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:01:40.610499"], ["updated_at", "2016-01-05 11:01:40.610499"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:01:40.612499"], ["updated_at", "2016-01-05 11:01:40.612499"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:01:40.623503"], ["updated_at", "2016-01-05 11:01:40.623503"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:01:40.633508"], ["updated_at", "2016-01-05 11:01:40.633508"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:01:40.635508"], ["updated_at", "2016-01-05 11:01:40.635508"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:01:40.636509"], ["updated_at", "2016-01-05 11:01:40.636509"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:01:40.641510"], ["updated_at", "2016-01-05 11:01:40.641510"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (10.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (24.1ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (10.1ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (12.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 11:03:17', '2016-01-05 11:03:17', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 11:03:17', '2016-01-05 11:03:17', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 11:03:17', '2016-01-05 11:03:17', 103210531)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 11:03:17', '2016-01-05 11:03:17', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 11:03:17', '2016-01-05 11:03:17', 83783397)[0m
  [1m[35mFixture Delete (12.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (13.1ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$YtoxftLe.1U.qD373vsWbeZ9rFb75Duz1ZNefgTrxrXpvA750Ixf6', '2016-01-05 11:03:17', '2016-01-05 11:03:17', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (2.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:03:17 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (195.2ms)
Completed 200 OK in 572ms (Views: 544.5ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:03:17 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 11:03:17.991819"], ["current_sign_in_at", "2016-01-05 11:03:17.991819"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:03:17.992820"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 31ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (2.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (11.0ms)
Completed 200 OK in 55ms (Views: 52.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 22ms (Views: 19.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 17ms (Views: 15.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (11.0ms)
Completed 200 OK in 13ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 11:03:18.201939"], ["current_sign_in_at", "2016-01-05 11:03:18.201939"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:03:18.202940"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:03:18.222948"], ["updated_at", "2016-01-05 11:03:18.222948"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (39.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (43.0ms)
Completed 200 OK in 45ms (Views: 44.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 11:03:18.290976"], ["current_sign_in_at", "2016-01-05 11:03:18.290976"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:03:18.291975"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 3ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:03:18.309982"], ["updated_at", "2016-01-05 11:03:18.309982"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 11:03:18.339993"], ["current_sign_in_at", "2016-01-05 11:03:18.339993"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:03:18.340993"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (5.0ms)
Completed 200 OK in 7ms (Views: 6.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 11:03:18.375006"], ["current_sign_in_at", "2016-01-05 11:03:18.375006"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:03:18.376006"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 3.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:03:18 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:03:19 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52l5lksbis9ywbzs947", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 99900], ["updated_at", "2016-01-05 11:03:19.829099"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 727ms (ActiveRecord: 3.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 18:03:19 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:03:19 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:03:20 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l5ll2xof35swr9xgv", "charity"=>"random"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 11:03:20.946126"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 459ms (ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:03:20 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 9ms (Views: 7.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:03:21 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l5llaj58bdja5bm94", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 11:03:22.010957"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 523ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:03:22 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:03:22 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 11:03:22.037968"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 11:03:22.042970"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 11:03:22.044970"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:03:22.053974"], ["updated_at", "2016-01-05 11:03:22.053974"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:03:22.058977"], ["updated_at", "2016-01-05 11:03:22.058977"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:03:22.061978"], ["updated_at", "2016-01-05 11:03:22.061978"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:03:22.075982"], ["updated_at", "2016-01-05 11:03:22.075982"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:03:22.077983"], ["updated_at", "2016-01-05 11:03:22.077983"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:03:22.079984"], ["updated_at", "2016-01-05 11:03:22.079984"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:03:22.082985"], ["updated_at", "2016-01-05 11:03:22.082985"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:03:22.083985"], ["updated_at", "2016-01-05 11:03:22.083985"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:03:22.085986"], ["updated_at", "2016-01-05 11:03:22.085986"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (6.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (14.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 11:06:59', '2016-01-05 11:06:59', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 11:06:59', '2016-01-05 11:06:59', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 11:06:59', '2016-01-05 11:06:59', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 11:06:59', '2016-01-05 11:06:59', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 11:06:59', '2016-01-05 11:06:59', 83783397)[0m
  [1m[35mFixture Delete (14.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (20.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$6VKJIIr4/93AuMh32lDJXukyGeGVpCHQ3EkczONwHKBnC3aLf18Pi', '2016-01-05 11:06:59', '2016-01-05 11:06:59', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-05 11:06:59.811350"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 11:06:59.816351"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 11:06:59.821353"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:06:59 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (9.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (238.2ms)
Completed 200 OK in 676ms (Views: 649.4ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 11:07:00.577812"], ["current_sign_in_at", "2016-01-05 11:07:00.577812"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:07:00.578812"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 30ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (6.0ms)
Completed 200 OK in 44ms (Views: 41.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 21ms (Views: 18.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:07:00.715869"], ["updated_at", "2016-01-05 11:07:00.715869"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 6ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (5.0ms)
Completed 200 OK in 15ms (Views: 13.0ms | ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 13ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 11:07:00.766890"], ["current_sign_in_at", "2016-01-05 11:07:00.766890"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:07:00.768890"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 10ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (8.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 14ms (Views: 2.0ms | ActiveRecord: 8.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (5.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 11:07:00.878935"], ["current_sign_in_at", "2016-01-05 11:07:00.878935"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:07:00.878935"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:07:00 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (19.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (24.0ms)
Completed 200 OK in 29ms (Views: 27.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 11:07:01.175297"], ["current_sign_in_at", "2016-01-05 11:07:01.175297"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:07:01.176298"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (5.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 11:07:01.216313"], ["current_sign_in_at", "2016-01-05 11:07:01.216313"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:07:01.219314"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:07:01.240323"], ["updated_at", "2016-01-05 11:07:01.240323"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (6.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 17ms (Views: 16.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:07:01 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52l5mvuhlp0unyygs0m", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 99900], ["updated_at", "2016-01-05 11:07:02.488920"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 533ms (ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:07:02 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:07:02 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 6ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:07:02 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 18:07:02 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:07:03 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l5mw4c178ejsit7s4", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 11:07:03.711657"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 468ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:07:03 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:07:04 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l5mwf4rzuo0e7xtbu", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 11:07:05.214179"], ["id", 83783397]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 518ms (ActiveRecord: 3.0ms)
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:07:05.231186"], ["updated_at", "2016-01-05 11:07:05.231186"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:07:05.235189"], ["updated_at", "2016-01-05 11:07:05.235189"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:07:05.238190"], ["updated_at", "2016-01-05 11:07:05.238190"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:07:05.241191"], ["updated_at", "2016-01-05 11:07:05.241191"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:07:05.243192"], ["updated_at", "2016-01-05 11:07:05.243192"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:07:05.245193"], ["updated_at", "2016-01-05 11:07:05.245193"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:07:05.257196"], ["updated_at", "2016-01-05 11:07:05.257196"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:07:05.259197"], ["updated_at", "2016-01-05 11:07:05.259197"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:07:05.261199"], ["updated_at", "2016-01-05 11:07:05.261199"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (11.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (68.1ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (14.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (83.4ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (72.2ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-05 11:09:09', '2016-01-05 11:09:09', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-05 11:09:09', '2016-01-05 11:09:09', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-05 11:09:09', '2016-01-05 11:09:09', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-05 11:09:09', '2016-01-05 11:09:09', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-05 11:09:09', '2016-01-05 11:09:09', 83783397)[0m
  [1m[35mFixture Delete (49.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (16.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$SZdjE2DmxzAw0o9T4Q.JCegdnmXnab52vhosUlIBKqFenOJ8eRAMO', '2016-01-05 11:09:09', '2016-01-05 11:09:09', 830138774)[0m
  [1m[35m (7.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:09:09.572133"], ["updated_at", "2016-01-05 11:09:09.572133"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:09:09.583137"], ["updated_at", "2016-01-05 11:09:09.583137"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:09:09.585138"], ["updated_at", "2016-01-05 11:09:09.585138"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:09:09.587139"], ["updated_at", "2016-01-05 11:09:09.587139"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:09:09.591140"], ["updated_at", "2016-01-05 11:09:09.591140"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:09:09.631156"], ["updated_at", "2016-01-05 11:09:09.631156"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:09:09.636159"], ["updated_at", "2016-01-05 11:09:09.636159"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:09:09.638160"], ["updated_at", "2016-01-05 11:09:09.638160"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:09:09.639160"], ["updated_at", "2016-01-05 11:09:09.639160"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (11.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:09:09 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (20.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 516ms (Views: 493.6ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:09:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:09:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:09:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52l5nn5ffectu83pvmi", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 99900], ["updated_at", "2016-01-05 11:09:11.824824"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 630ms (ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:09:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:09:12 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l5nnhwm7ma1xoju6b", "charity"=>"random"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 11:09:13.330729"], ["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 500ms (ActiveRecord: 1.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-05 18:09:13 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52l5nnoy55z319ldtu0", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 11:09:14.475681"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 696ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 6ms (Views: 5.0ms | ActiveRecord: 1.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (9.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (143.1ms)
Completed 200 OK in 169ms (Views: 162.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 11:09:14.711777"], ["current_sign_in_at", "2016-01-05 11:09:14.711777"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:09:14.712777"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 27ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 16ms (Views: 13.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:09:14.776803"], ["updated_at", "2016-01-05 11:09:14.776803"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 14ms (Views: 12.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 11:09:14.818833"], ["current_sign_in_at", "2016-01-05 11:09:14.818833"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:09:14.819834"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 11:09:14.854848"], ["current_sign_in_at", "2016-01-05 11:09:14.854848"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:09:14.855848"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-05 11:09:14.922877"], ["current_sign_in_at", "2016-01-05 11:09:14.922877"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:09:14.923877"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-05 11:09:14.941885"], ["updated_at", "2016-01-05 11:09:14.941885"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 3ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-05 11:09:14.971896"], ["current_sign_in_at", "2016-01-05 11:09:14.971896"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-05 11:09:14.972897"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-05 18:09:14 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-05 11:09:14.998906"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-05 11:09:14.999907"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-05 11:09:15.003909"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (11.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (92.1ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 04:42:56', '2016-01-06 04:42:56', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 04:42:56', '2016-01-06 04:42:56', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 04:42:56', '2016-01-06 04:42:56', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 04:42:56', '2016-01-06 04:42:56', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 04:42:56', '2016-01-06 04:42:56', 83783397)[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (11.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$0tAMAoGHutxNqiYQSJO9b.opdgVVmIQV5y/nQPbF2ZB/eI5vGZbA2', '2016-01-06 04:42:56', '2016-01-06 04:42:56', 830138774)[0m
  [1m[35m (8.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 11:42:56 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (191.2ms)
Completed 200 OK in 596ms (Views: 564.4ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 04:42:57.210231"], ["current_sign_in_at", "2016-01-06 04:42:57.210231"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 04:42:57.211232"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 37ms (ActiveRecord: 4.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (2.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (10.0ms)
Completed 200 OK in 46ms (Views: 43.1ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 16ms (Views: 12.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 18ms (Views: 16.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 04:42:57.407389"], ["current_sign_in_at", "2016-01-06 04:42:57.407389"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 04:42:57.408389"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (41.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (44.0ms)
Completed 200 OK in 46ms (Views: 46.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 04:42:57.490422"], ["current_sign_in_at", "2016-01-06 04:42:57.490422"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 04:42:57.491422"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 04:42:57.541440"], ["current_sign_in_at", "2016-01-06 04:42:57.541440"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 04:42:57.542440"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 04:42:57.560447"], ["updated_at", "2016-01-06 04:42:57.560447"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 04:42:57.591458"], ["current_sign_in_at", "2016-01-06 04:42:57.591458"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 04:42:57.592459"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 04:42:57.614468"], ["updated_at", "2016-01-06 04:42:57.614468"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 04:42:57.627472"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-06 04:42:57.647480"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 04:42:57.649481"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 11:42:57 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 500 Internal Server Error in 326ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 11:42:58 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52lfyl1o7ehlfnf1f64", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 99900], ["updated_at", "2016-01-06 04:42:58.962494"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 501ms (ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 11:42:59 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (11.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 19ms (Views: 19.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 11:42:59 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-06 11:42:59 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52lfyl9lgeskpj42hzd", "charity"=>"random"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 04:43:00.021954"], ["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 522ms (ActiveRecord: 2.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 11:43:00 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 500 Internal Server Error in 358ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 11:43:00 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52lfylki930l3fv1nqh", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 04:43:01.538776"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 586ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 11:43:01 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 11:43:01 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 04:43:01.567789"], ["updated_at", "2016-01-06 04:43:01.567789"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 04:43:01.569788"], ["updated_at", "2016-01-06 04:43:01.569788"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 04:43:01.571789"], ["updated_at", "2016-01-06 04:43:01.571789"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 04:43:01.581792"], ["updated_at", "2016-01-06 04:43:01.581792"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 04:43:01.583794"], ["updated_at", "2016-01-06 04:43:01.583794"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 04:43:01.584794"], ["updated_at", "2016-01-06 04:43:01.584794"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 04:43:01.589796"], ["updated_at", "2016-01-06 04:43:01.589796"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 04:43:01.594798"], ["updated_at", "2016-01-06 04:43:01.594798"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 04:43:01.600800"], ["updated_at", "2016-01-06 04:43:01.600800"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (5.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 05:52:44', '2016-01-06 05:52:44', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 05:52:44', '2016-01-06 05:52:44', 459292723)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 05:52:44', '2016-01-06 05:52:44', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 05:52:44', '2016-01-06 05:52:44', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 05:52:44', '2016-01-06 05:52:44', 83783397)[0m
  [1m[35mFixture Delete (17.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (7.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$e5rLOllOk84pd3zDGzitCOYCmo2dcRnkfdWiKnSNysqYU9XF44fDC', '2016-01-06 05:52:44', '2016-01-06 05:52:44', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-06 05:52:44.851403"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 05:52:44.856405"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 05:52:44.862406"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:52:44 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (12.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 906ms (Views: 806.6ms | ActiveRecord: 2.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:52:45 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:52:45 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 500 Internal Server Error in 430ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:52:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 500 Internal Server Error in 523ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 12:52:46 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (39.0ms)
Completed 200 OK in 41ms (Views: 40.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:52:47 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52lgn5s1ilhl5whffla", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 99900], ["updated_at", "2016-01-06 05:52:47.972356"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 542ms (ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:52:48 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52lgn62vulu8cnimyvs", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 05:52:49.314789"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 463ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:52:49 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:52:49 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52lgn6a9b56gnufk11y", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 05:52:50.400674"], ["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 515ms (ActiveRecord: 3.0ms)
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (131.1ms)
Completed 200 OK in 172ms (Views: 163.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 05:52:50.661852"], ["current_sign_in_at", "2016-01-06 05:52:50.661852"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:52:50.662853"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 28ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 24ms (Views: 22.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 7ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 05:52:50.814911"], ["current_sign_in_at", "2016-01-06 05:52:50.814911"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:52:50.815911"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 47ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 13ms (Views: 9.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 05:52:50.900943"], ["current_sign_in_at", "2016-01-06 05:52:50.900943"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:52:50.901944"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 05:52:50.939957"], ["current_sign_in_at", "2016-01-06 05:52:50.939957"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:52:50.940958"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:52:50.960965"], ["updated_at", "2016-01-06 05:52:50.960965"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:52:50 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 05:52:50.995980"], ["current_sign_in_at", "2016-01-06 05:52:50.995980"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:52:50.996980"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:52:51 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:52:51 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 8ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 12:52:51 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:52:51.021988"], ["updated_at", "2016-01-06 05:52:51.021988"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:52:51 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:52:51 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:52:51.048999"], ["updated_at", "2016-01-06 05:52:51.048999"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:52:51.056002"], ["updated_at", "2016-01-06 05:52:51.056002"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:52:51.058002"], ["updated_at", "2016-01-06 05:52:51.058002"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:52:51.060003"], ["updated_at", "2016-01-06 05:52:51.060003"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:52:51.068006"], ["updated_at", "2016-01-06 05:52:51.068006"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:52:51.077009"], ["updated_at", "2016-01-06 05:52:51.077009"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:52:51.078010"], ["updated_at", "2016-01-06 05:52:51.078010"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:52:51.080010"], ["updated_at", "2016-01-06 05:52:51.080010"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:52:51.083011"], ["updated_at", "2016-01-06 05:52:51.083011"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (3.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (14.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 05:55:55', '2016-01-06 05:55:55', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 05:55:55', '2016-01-06 05:55:55', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 05:55:55', '2016-01-06 05:55:55', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 05:55:55', '2016-01-06 05:55:55', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 05:55:55', '2016-01-06 05:55:55', 83783397)[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (8.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$3fjDDz03KPwcydTwZ7.6h.PNTZAtkODiFxO29D5xrUx.Doza8KpcS', '2016-01-06 05:55:55', '2016-01-06 05:55:55', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:55:55.967061"], ["updated_at", "2016-01-06 05:55:55.967061"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:55:56.011080"], ["updated_at", "2016-01-06 05:55:56.011080"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:55:56.015082"], ["updated_at", "2016-01-06 05:55:56.015082"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:55:56.056100"], ["updated_at", "2016-01-06 05:55:56.056100"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:55:56.059102"], ["updated_at", "2016-01-06 05:55:56.059102"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:55:56.061102"], ["updated_at", "2016-01-06 05:55:56.061102"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:55:56.073108"], ["updated_at", "2016-01-06 05:55:56.073108"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:55:56.075108"], ["updated_at", "2016-01-06 05:55:56.075108"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:55:56.076108"], ["updated_at", "2016-01-06 05:55:56.076108"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:55:56 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52lgo9qbpmu869bc3vs", "charity"=>"random"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 05:55:57.289655"], ["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 625ms (ActiveRecord: 1.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:55:57 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (12.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 483ms (Views: 481.2ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:55:58 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52lgoa32fb9konz30uj", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 05:55:58.791409"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 531ms (ActiveRecord: 4.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:55:58 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (7.0ms)
Completed 200 OK in 13ms (Views: 11.0ms | ActiveRecord: 1.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:55:58 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 12:55:58 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:55:58 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 500 Internal Server Error in 256ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:55:59 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52lgoad8zp3uyqdi1yo", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 1204ms (Views: 8.0ms | ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:56:00 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 500 Internal Server Error in 319ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 05:56:01.164822"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-06 05:56:01.170823"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 05:56:01.172823"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 67ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (134.2ms)
Completed 200 OK in 172ms (Views: 168.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 05:56:01.537207"], ["current_sign_in_at", "2016-01-06 05:56:01.537207"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:56:01.538207"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 47ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (11.0ms)
Completed 200 OK in 27ms (Views: 25.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 7ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 05:56:01.648282"], ["current_sign_in_at", "2016-01-06 05:56:01.648282"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:56:01.649282"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (5.0ms)
Completed 200 OK in 14ms (Views: 11.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 05:56:01.697304"], ["current_sign_in_at", "2016-01-06 05:56:01.697304"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:56:01.698304"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:56:01.720314"], ["updated_at", "2016-01-06 05:56:01.720314"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 05:56:01.753329"], ["current_sign_in_at", "2016-01-06 05:56:01.753329"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:56:01.754330"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 05:56:01.827390"], ["current_sign_in_at", "2016-01-06 05:56:01.827390"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:56:01.827390"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:56:01.848400"], ["updated_at", "2016-01-06 05:56:01.848400"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:01 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (14.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (11.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (6.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 05:56:57', '2016-01-06 05:56:57', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 05:56:57', '2016-01-06 05:56:57', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 05:56:57', '2016-01-06 05:56:57', 103210531)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 05:56:57', '2016-01-06 05:56:57', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 05:56:57', '2016-01-06 05:56:57', 83783397)[0m
  [1m[35mFixture Delete (9.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$k5vHRrTDeIP19A3nvzX/ve7Qvf83o95FLr.Po/XVX9VWnPUgPri1e', '2016-01-06 05:56:57', '2016-01-06 05:56:57', 830138774)[0m
  [1m[35m (4.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 05:56:57.371722"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-06 05:56:57.385728"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 05:56:57.386729"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:57 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (185.1ms)
Completed 200 OK in 645ms (Views: 615.4ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 05:56:58.118131"], ["current_sign_in_at", "2016-01-06 05:56:58.118131"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:56:58.120133"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 28ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (6.0ms)
Completed 200 OK in 72ms (Views: 70.1ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 61ms (Views: 59.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (7.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 12ms (Views: 2.0ms | ActiveRecord: 7.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 05:56:58.391321"], ["current_sign_in_at", "2016-01-06 05:56:58.391321"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:56:58.391321"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (29.0ms)
Completed 200 OK in 45ms (Views: 42.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (40.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (47.0ms)
Completed 200 OK in 50ms (Views: 49.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 05:56:58.511374"], ["current_sign_in_at", "2016-01-06 05:56:58.511374"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:56:58.511374"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:56:58.531383"], ["updated_at", "2016-01-06 05:56:58.531383"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 05:56:58.563397"], ["current_sign_in_at", "2016-01-06 05:56:58.563397"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:56:58.564398"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:56:58.585407"], ["updated_at", "2016-01-06 05:56:58.585407"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 05:56:58.629435"], ["current_sign_in_at", "2016-01-06 05:56:58.629435"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:56:58.630438"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (3.0ms)
Completed 200 OK in 8ms (Views: 5.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:56:58 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 11ms (Views: 11.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 12:56:59 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:56:59 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 500 Internal Server Error in 650ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:57:00 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52lgon73cvtsg8kd791", "charity"=>"random"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 05:57:00.941682"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 598ms (ActiveRecord: 0.0ms)
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:57:01 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52lgonfc1l0jlutduo1", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 1100ms (Views: 7.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:57:02 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 9ms (Views: 6.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:57:02 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_X", "charity"=>"563589564"}
Completed 500 Internal Server Error in 278ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:57:03 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52lgontfu294talqzsn", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 05:57:03.781243"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 495ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:57:03 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (65.0ms)
Completed 200 OK in 68ms (Views: 66.0ms | ActiveRecord: 1.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:57:03.869282"], ["updated_at", "2016-01-06 05:57:03.869282"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:57:03.871282"], ["updated_at", "2016-01-06 05:57:03.871282"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:57:03.873284"], ["updated_at", "2016-01-06 05:57:03.873284"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:57:03.876295"], ["updated_at", "2016-01-06 05:57:03.876295"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:57:03.879287"], ["updated_at", "2016-01-06 05:57:03.879287"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:57:03.888290"], ["updated_at", "2016-01-06 05:57:03.888290"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:57:03.890291"], ["updated_at", "2016-01-06 05:57:03.890291"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:57:03.891292"], ["updated_at", "2016-01-06 05:57:03.891292"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:57:03.898295"], ["updated_at", "2016-01-06 05:57:03.898295"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (13.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (79.1ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 05:59:15', '2016-01-06 05:59:15', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 05:59:15', '2016-01-06 05:59:15', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 05:59:15', '2016-01-06 05:59:15', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 05:59:15', '2016-01-06 05:59:15', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 05:59:15', '2016-01-06 05:59:15', 83783397)[0m
  [1m[35mFixture Delete (12.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$3nhaBDMfieBwdYMk5uoO4OZCbbmraqNEXUrTOzUCg77MG.51PRKEm', '2016-01-06 05:59:15', '2016-01-06 05:59:15', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:59:15.164203"], ["updated_at", "2016-01-06 05:59:15.164203"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:59:15.170206"], ["updated_at", "2016-01-06 05:59:15.170206"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:59:15.172205"], ["updated_at", "2016-01-06 05:59:15.172205"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:59:15.173206"], ["updated_at", "2016-01-06 05:59:15.173206"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:59:15.208221"], ["updated_at", "2016-01-06 05:59:15.208221"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:59:15.257239"], ["updated_at", "2016-01-06 05:59:15.257239"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:59:15.259240"], ["updated_at", "2016-01-06 05:59:15.259240"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:59:15.260240"], ["updated_at", "2016-01-06 05:59:15.260240"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:59:15.264242"], ["updated_at", "2016-01-06 05:59:15.264242"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:59:15 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (99.1ms)
Completed 200 OK in 508ms (Views: 480.3ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:59:15 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (3.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 05:59:15.864590"], ["current_sign_in_at", "2016-01-06 05:59:15.864590"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:59:15.865590"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 31ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:59:15 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 57ms (Views: 57.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:59:15 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 16ms (Views: 11.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 17ms (Views: 15.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 05:59:16.063668"], ["current_sign_in_at", "2016-01-06 05:59:16.063668"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:59:16.064670"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 6ms (Views: 6.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (36.0ms)
Completed 200 OK in 39ms (Views: 37.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 05:59:16.147703"], ["current_sign_in_at", "2016-01-06 05:59:16.147703"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:59:16.147703"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:59:16.166710"], ["updated_at", "2016-01-06 05:59:16.166710"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 05:59:16.194721"], ["current_sign_in_at", "2016-01-06 05:59:16.194721"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:59:16.195722"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 13ms (Views: 13.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 05:59:16.244741"], ["current_sign_in_at", "2016-01-06 05:59:16.244741"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 05:59:16.245742"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 05:59:16.263748"], ["updated_at", "2016-01-06 05:59:16.263748"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 12:59:16 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 05:59:16.276754"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-06 05:59:16.280754"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 05:59:16.281755"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:59:17 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52lgpg2108j0o0wqjgi", "charity"=>"random"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 05:59:17.605588"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 564ms (ActiveRecord: 2.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:59:17 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 12ms (Views: 10.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:59:18 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"tokn_test_52lgpga1qcpegxjzfes", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (5.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 348ms (Views: 8.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:59:19 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"tokn_test_52lgpgjsdf563gs5ys8", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 297ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:59:20 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"tokn_test_52lgpgqq2k33090tc3n", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 1043ms (Views: 6.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 12:59:21 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:59:21 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_test_52lgph364wbvtwh8dm5", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 05:59:22.479723"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 594ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 12:59:22 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 7ms (Views: 5.0ms | ActiveRecord: 1.0ms)
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 12:59:22 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 8ms (Views: 5.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (11.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (11.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (14.1ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (15.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 07:44:37', '2016-01-06 07:44:37', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 07:44:37', '2016-01-06 07:44:37', 459292723)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 07:44:37', '2016-01-06 07:44:37', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 07:44:37', '2016-01-06 07:44:37', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 07:44:37', '2016-01-06 07:44:37', 83783397)[0m
  [1m[35mFixture Delete (16.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$GWG7CTzg8r0CutckD5XqGOmTWH5IZu/Lwf9TW6aruIOrQG3w/Y08W', '2016-01-06 07:44:37', '2016-01-06 07:44:37', 830138774)[0m
  [1m[35m (3.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 07:44:37.491939"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 07:44:37.495941"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 07:44:37.502945"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 14:44:37 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (198.1ms)
Completed 200 OK in 2164ms (Views: 2134.9ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 14:44:39 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (3.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (3.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 07:44:39.770927"], ["current_sign_in_at", "2016-01-06 07:44:39.770927"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 07:44:39.772925"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 84ms (ActiveRecord: 7.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 14:44:39 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (2.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (7.0ms)
Completed 200 OK in 67ms (Views: 64.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 14:44:39 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 29ms (Views: 25.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 07:44:40.022069"], ["updated_at", "2016-01-06 07:44:40.022069"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 16ms (Views: 14.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 07:44:40.066086"], ["current_sign_in_at", "2016-01-06 07:44:40.066086"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 07:44:40.067087"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 7ms (Views: 5.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (39.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (42.0ms)
Completed 200 OK in 44ms (Views: 43.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 07:44:40.140115"], ["current_sign_in_at", "2016-01-06 07:44:40.140115"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 07:44:40.141117"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 07:44:40.160125"], ["updated_at", "2016-01-06 07:44:40.160125"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (5.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 07:44:40.201139"], ["current_sign_in_at", "2016-01-06 07:44:40.201139"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 07:44:40.202140"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (13.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 17ms (Views: 2.0ms | ActiveRecord: 13.2ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (5.0ms)
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 07:44:40.256322"], ["current_sign_in_at", "2016-01-06 07:44:40.256322"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 07:44:40.257322"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 07:44:40.315433"], ["updated_at", "2016-01-06 07:44:40.315433"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 07:44:40.369453"], ["updated_at", "2016-01-06 07:44:40.369453"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 07:44:40.372454"], ["updated_at", "2016-01-06 07:44:40.372454"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 07:44:40.376458"], ["updated_at", "2016-01-06 07:44:40.376458"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 07:44:40.378456"], ["updated_at", "2016-01-06 07:44:40.378456"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 07:44:40.380459"], ["updated_at", "2016-01-06 07:44:40.380459"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 07:44:40.393462"], ["updated_at", "2016-01-06 07:44:40.393462"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 07:44:40.395463"], ["updated_at", "2016-01-06 07:44:40.395463"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 07:44:40.396464"], ["updated_at", "2016-01-06 07:44:40.396464"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 14:44:40 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (13.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (4.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (11.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 08:10:06', '2016-01-06 08:10:06', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 08:10:06', '2016-01-06 08:10:06', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 08:10:06', '2016-01-06 08:10:06', 103210531)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 08:10:06', '2016-01-06 08:10:06', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 08:10:06', '2016-01-06 08:10:06', 83783397)[0m
  [1m[35mFixture Delete (12.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (11.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$6eBm0bjV5ZF1apCpd6rKF.lodKK17Rm/emlEfBXuF3D/7ZzoWohvu', '2016-01-06 08:10:06', '2016-01-06 08:10:06', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:10:06 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 32ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:10:06 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (121.0ms)
Completed 200 OK in 480ms (Views: 475.3ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:10:06 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (2.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:10:06.808415"], ["current_sign_in_at", "2016-01-06 08:10:06.808415"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:10:06.810415"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 33ms (ActiveRecord: 4.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:10:06 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (10.0ms)
Completed 200 OK in 69ms (Views: 67.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:10:06 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 18ms (Views: 13.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:10:06 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 20ms (Views: 17.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:10:06 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:10:07.008519"], ["current_sign_in_at", "2016-01-06 08:10:07.008519"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:10:07.009519"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:10:07.101553"], ["current_sign_in_at", "2016-01-06 08:10:07.101553"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:10:07.102553"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:10:07.123561"], ["updated_at", "2016-01-06 08:10:07.123561"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:10:07.155574"], ["current_sign_in_at", "2016-01-06 08:10:07.155574"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:10:07.156574"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 13ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:10:07.197589"], ["current_sign_in_at", "2016-01-06 08:10:07.197589"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:10:07.198589"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:10:07.218598"], ["updated_at", "2016-01-06 08:10:07.218598"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 3.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:10:07.231603"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:10:07.257612"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:10:07.259614"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Completed 500 Internal Server Error in 32ms (ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:10:07 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:10:07.431689"], ["updated_at", "2016-01-06 08:10:07.431689"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:10:07.434690"], ["updated_at", "2016-01-06 08:10:07.434690"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:10:07.438692"], ["updated_at", "2016-01-06 08:10:07.438692"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:10:07.451697"], ["updated_at", "2016-01-06 08:10:07.451697"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:10:07.453698"], ["updated_at", "2016-01-06 08:10:07.453698"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:10:07.454698"], ["updated_at", "2016-01-06 08:10:07.454698"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:10:07.458700"], ["updated_at", "2016-01-06 08:10:07.458700"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:10:07.460701"], ["updated_at", "2016-01-06 08:10:07.460701"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:10:07.461701"], ["updated_at", "2016-01-06 08:10:07.461701"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (4.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (14.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 08:11:37', '2016-01-06 08:11:37', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 08:11:37', '2016-01-06 08:11:37', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 08:11:37', '2016-01-06 08:11:37', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 08:11:37', '2016-01-06 08:11:37', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 08:11:37', '2016-01-06 08:11:37', 83783397)[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (8.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$BXdHno7VO4Mf2z3j.eGD9OymXiSLlV2VfwEr9jFFZ40q.92UEdCje', '2016-01-06 08:11:37', '2016-01-06 08:11:37', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:11:37.514526"], ["updated_at", "2016-01-06 08:11:37.514526"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:11:37.528532"], ["updated_at", "2016-01-06 08:11:37.528532"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:11:37.530532"], ["updated_at", "2016-01-06 08:11:37.530532"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:11:37.532533"], ["updated_at", "2016-01-06 08:11:37.532533"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:11:37.609563"], ["updated_at", "2016-01-06 08:11:37.609563"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:11:37.612564"], ["updated_at", "2016-01-06 08:11:37.612564"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:11:37.614565"], ["updated_at", "2016-01-06 08:11:37.614565"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:11:37.616566"], ["updated_at", "2016-01-06 08:11:37.616566"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (2.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:11:37.624568"], ["updated_at", "2016-01-06 08:11:37.624568"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:11:37 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (104.0ms)
Completed 200 OK in 504ms (Views: 477.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:11:38.224828"], ["current_sign_in_at", "2016-01-06 08:11:38.224828"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:11:38.225828"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 26ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 54ms (Views: 53.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 17ms (Views: 14.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 20ms (Views: 14.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:11:38.421903"], ["current_sign_in_at", "2016-01-06 08:11:38.421903"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:11:38.422903"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 42ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:11:38.499932"], ["current_sign_in_at", "2016-01-06 08:11:38.499932"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:11:38.500934"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:11:38.521941"], ["updated_at", "2016-01-06 08:11:38.521941"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:11:38.555953"], ["current_sign_in_at", "2016-01-06 08:11:38.555953"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:11:38.556954"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (5.0ms)
Completed 200 OK in 7ms (Views: 6.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:11:38.580964"], ["updated_at", "2016-01-06 08:11:38.580964"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 6ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:11:38.613975"], ["current_sign_in_at", "2016-01-06 08:11:38.613975"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:11:38.614977"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
Completed 500 Internal Server Error in 3ms (ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:11:38 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:11:38.758030"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:11:38.764032"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:11:38.766033"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (62.1ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 08:16:08', '2016-01-06 08:16:08', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 08:16:08', '2016-01-06 08:16:08', 459292723)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 08:16:08', '2016-01-06 08:16:08', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 08:16:08', '2016-01-06 08:16:08', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 08:16:08', '2016-01-06 08:16:08', 83783397)[0m
  [1m[35mFixture Delete (10.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (8.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$U9drz2/0MXX2ywsS4nAzBOP.FzMXHud4Gea.KtCwEs8XK893h79wK', '2016-01-06 08:16:08', '2016-01-06 08:16:08', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:16:09.066073"], ["updated_at", "2016-01-06 08:16:09.066073"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:16:09.071075"], ["updated_at", "2016-01-06 08:16:09.071075"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:16:09.073077"], ["updated_at", "2016-01-06 08:16:09.073077"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:16:09.075077"], ["updated_at", "2016-01-06 08:16:09.075077"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:16:09.089082"], ["updated_at", "2016-01-06 08:16:09.089082"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:16:09.091083"], ["updated_at", "2016-01-06 08:16:09.091083"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:16:09.093084"], ["updated_at", "2016-01-06 08:16:09.093084"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:16:09.098086"], ["updated_at", "2016-01-06 08:16:09.098086"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:16:09.128098"], ["updated_at", "2016-01-06 08:16:09.128098"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:16:09.135100"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:16:09.140103"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:16:09.144104"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:16:09 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (102.0ms)
Completed 200 OK in 529ms (Views: 496.4ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:16:09 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:16:09.775533"], ["current_sign_in_at", "2016-01-06 08:16:09.775533"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:16:09.776533"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 26ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:16:09 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 57ms (Views: 56.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:16:09 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (5.0ms)
Completed 200 OK in 18ms (Views: 16.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:16:09 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 20ms (Views: 18.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:16:09 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:16:09 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:16:09.967645"], ["current_sign_in_at", "2016-01-06 08:16:09.967645"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:16:09.968646"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:16:09 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (36.0ms)
Completed 200 OK in 39ms (Views: 37.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:16:10.046678"], ["current_sign_in_at", "2016-01-06 08:16:10.046678"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:16:10.047678"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:16:10.092696"], ["current_sign_in_at", "2016-01-06 08:16:10.092696"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:16:10.093698"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:16:10.116705"], ["updated_at", "2016-01-06 08:16:10.116705"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 3ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 13ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:16:10.153720"], ["current_sign_in_at", "2016-01-06 08:16:10.153720"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:16:10.154720"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 3ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:16:10.173728"], ["updated_at", "2016-01-06 08:16:10.173728"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 2ms (ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:16:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (14.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (14.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (15.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 08:17:23', '2016-01-06 08:17:23', 563589564)[0m
  [1m[35mFixture Insert (0.9ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 08:17:23', '2016-01-06 08:17:23', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 08:17:23', '2016-01-06 08:17:23', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 08:17:23', '2016-01-06 08:17:23', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 08:17:23', '2016-01-06 08:17:23', 83783397)[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (11.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$SHIUCneGyWoRQ4spbZayuu4xeisgkW1e80CzqZPPW0A5ObmdNip1.', '2016-01-06 08:17:23', '2016-01-06 08:17:23', 830138774)[0m
  [1m[35m (11.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:17:23.820418"], ["updated_at", "2016-01-06 08:17:23.820418"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:17:23.826421"], ["updated_at", "2016-01-06 08:17:23.826421"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:17:23.828423"], ["updated_at", "2016-01-06 08:17:23.828423"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:17:23.830424"], ["updated_at", "2016-01-06 08:17:23.830424"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (6.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:17:23.890447"], ["updated_at", "2016-01-06 08:17:23.890447"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:17:23.891447"], ["updated_at", "2016-01-06 08:17:23.891447"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:17:23.893448"], ["updated_at", "2016-01-06 08:17:23.893448"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:17:23.897449"], ["updated_at", "2016-01-06 08:17:23.897449"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:17:23.899451"], ["updated_at", "2016-01-06 08:17:23.899451"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:17:23 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:17:24.000493"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 27ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:17:24 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (12.0ms)
Completed 200 OK in 2595ms (Views: 2595.3ms | ActiveRecord: 0.0ms)
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:17:26 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 6ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:17:26 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:17:26 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:17:26 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 15:17:26 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:17:26 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:17:26 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:17:26.705833"], ["id", 917085421]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 5ms (ActiveRecord: 3.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:17:26 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (113.0ms)
Completed 200 OK in 150ms (Views: 141.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:17:26 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (3.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:17:26.934924"], ["current_sign_in_at", "2016-01-06 08:17:26.934924"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:17:26.935933"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 69ms (ActiveRecord: 4.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:17:26 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 17ms (Views: 15.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 41ms (Views: 39.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (5.0ms)
Completed 200 OK in 7ms (Views: 6.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:17:27.152010"], ["current_sign_in_at", "2016-01-06 08:17:27.152010"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:17:27.153018"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:17:27.188024"], ["current_sign_in_at", "2016-01-06 08:17:27.188024"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:17:27.189025"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:17:27.210034"], ["updated_at", "2016-01-06 08:17:27.210034"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (22.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 12ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:17:27.267085"], ["current_sign_in_at", "2016-01-06 08:17:27.267085"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:17:27.268085"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:17:27.320105"], ["current_sign_in_at", "2016-01-06 08:17:27.320105"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:17:27.321106"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:17:27.340114"], ["updated_at", "2016-01-06 08:17:27.340114"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:17:27 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:17:27.354119"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:17:27.356119"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:17:27.360122"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (15.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (15.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (16.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (14.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 08:19:30', '2016-01-06 08:19:30', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 08:19:30', '2016-01-06 08:19:30', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 08:19:30', '2016-01-06 08:19:30', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 08:19:30', '2016-01-06 08:19:30', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 08:19:30', '2016-01-06 08:19:30', 83783397)[0m
  [1m[35mFixture Delete (68.1ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (14.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$pMNQJsr/QKOkWOuMP5ELcOveL6CLvXCtQmguoiv/6.QFkQF1E5J7a', '2016-01-06 08:19:30', '2016-01-06 08:19:30', 830138774)[0m
  [1m[35m (7.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (3.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:19:30.433414"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:19:30.441417"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.9ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:19:30.446419"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (7.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:19:30.524502"], ["updated_at", "2016-01-06 08:19:30.524502"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:19:30.526503"], ["updated_at", "2016-01-06 08:19:30.526503"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:19:30.529504"], ["updated_at", "2016-01-06 08:19:30.529504"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (4.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:19:30.546511"], ["updated_at", "2016-01-06 08:19:30.546511"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:19:30.548512"], ["updated_at", "2016-01-06 08:19:30.548512"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:19:30.550512"], ["updated_at", "2016-01-06 08:19:30.550512"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:19:30.553513"], ["updated_at", "2016-01-06 08:19:30.553513"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:19:30.555514"], ["updated_at", "2016-01-06 08:19:30.555514"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:19:30.558515"], ["updated_at", "2016-01-06 08:19:30.558515"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:19:30 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (113.1ms)
Completed 200 OK in 638ms (Views: 607.4ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:19:31.294993"], ["current_sign_in_at", "2016-01-06 08:19:31.294993"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:19:31.295994"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 33ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 62ms (Views: 61.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (6.0ms)
Completed 200 OK in 20ms (Views: 17.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:19:31.465058"], ["current_sign_in_at", "2016-01-06 08:19:31.465058"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:19:31.466060"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 19ms (Views: 17.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 7ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:19:31.566098"], ["current_sign_in_at", "2016-01-06 08:19:31.566098"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:19:31.567098"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:19:31.587106"], ["updated_at", "2016-01-06 08:19:31.587106"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:19:31.628122"], ["current_sign_in_at", "2016-01-06 08:19:31.628122"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:19:31.629123"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:19:31.649130"], ["updated_at", "2016-01-06 08:19:31.649130"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (5.0ms)
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:19:31.682142"], ["current_sign_in_at", "2016-01-06 08:19:31.682142"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:19:31.683148"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 3ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:19:31.777240"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 3ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (16.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 17ms (Views: 17.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:19:31.855270"], ["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 5ms (ActiveRecord: 2.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:19:31 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (60.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 08:20:40', '2016-01-06 08:20:40', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 08:20:40', '2016-01-06 08:20:40', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 08:20:40', '2016-01-06 08:20:40', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 08:20:40', '2016-01-06 08:20:40', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 08:20:40', '2016-01-06 08:20:40', 83783397)[0m
  [1m[35mFixture Delete (15.1ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (8.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$bHOzknrukF6dIuClw7hRh.g6KBXxbgv29QFt17vM27tI0F7DX/IOq', '2016-01-06 08:20:40', '2016-01-06 08:20:40', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:20:40.583622"], ["updated_at", "2016-01-06 08:20:40.583622"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:20:40.588624"], ["updated_at", "2016-01-06 08:20:40.588624"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:20:40.600656"], ["updated_at", "2016-01-06 08:20:40.600656"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:20:40.601655"], ["updated_at", "2016-01-06 08:20:40.601655"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:20:40.608659"], ["updated_at", "2016-01-06 08:20:40.608659"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:20:40.671684"], ["updated_at", "2016-01-06 08:20:40.671684"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:20:40.680686"], ["updated_at", "2016-01-06 08:20:40.680686"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:20:40.682688"], ["updated_at", "2016-01-06 08:20:40.682688"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:20:40.683688"], ["updated_at", "2016-01-06 08:20:40.683688"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:20:40 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (5.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (99.1ms)
Completed 200 OK in 514ms (Views: 482.4ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:20:41.292175"], ["current_sign_in_at", "2016-01-06 08:20:41.292175"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:20:41.293175"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 26ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 38ms (Views: 37.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 22ms (Views: 20.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:20:41.435231"], ["current_sign_in_at", "2016-01-06 08:20:41.435231"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:20:41.436231"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:20:41.456238"], ["updated_at", "2016-01-06 08:20:41.456238"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 14ms (Views: 11.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:20:41.547273"], ["current_sign_in_at", "2016-01-06 08:20:41.547273"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:20:41.547273"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:20:41.604295"], ["current_sign_in_at", "2016-01-06 08:20:41.604295"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:20:41.605296"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:20:41.640309"], ["current_sign_in_at", "2016-01-06 08:20:41.640309"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:20:41.640309"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 3ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:20:41.659316"], ["updated_at", "2016-01-06 08:20:41.659316"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:20:41.673322"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:20:41.675321"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:20:41.680324"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 6ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:20:41.751352"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:20:41.770358"], ["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 15:20:41 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (14.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (8.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (11.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 08:23:10', '2016-01-06 08:23:10', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 08:23:10', '2016-01-06 08:23:10', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 08:23:10', '2016-01-06 08:23:10', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 08:23:10', '2016-01-06 08:23:10', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 08:23:10', '2016-01-06 08:23:10', 83783397)[0m
  [1m[35mFixture Delete (16.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$BxN2cmrtJRslONeNiOa/2.qD/skJVbuWK18Z9cUvGdM/f0fg0JFPq', '2016-01-06 08:23:10', '2016-01-06 08:23:10', 830138774)[0m
  [1m[35m (10.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:23:10.403791"], ["updated_at", "2016-01-06 08:23:10.403791"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:23:10.407793"], ["updated_at", "2016-01-06 08:23:10.407793"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:23:10.409796"], ["updated_at", "2016-01-06 08:23:10.409796"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (2.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:23:10.417836"], ["updated_at", "2016-01-06 08:23:10.417836"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:23:10.460852"], ["updated_at", "2016-01-06 08:23:10.460852"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:23:10.468854"], ["updated_at", "2016-01-06 08:23:10.468854"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:23:10.470855"], ["updated_at", "2016-01-06 08:23:10.470855"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:23:10.472857"], ["updated_at", "2016-01-06 08:23:10.472857"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:23:10.477858"], ["updated_at", "2016-01-06 08:23:10.477858"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:23:10 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (12.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 470ms (Views: 450.2ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:23:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 10ms (Views: 7.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 15:23:11 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 5.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:23:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:23:11.110097"], ["id", 459292723]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 5.0ms)
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:23:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 8ms (Views: 5.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:23:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:23:11.144110"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 5ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:23:11 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 17ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:23:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:23:11 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:23:11 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (13.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (962.0ms)
Completed 200 OK in 1191ms (Views: 1179.2ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (27.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:23:12.490347"], ["current_sign_in_at", "2016-01-06 08:23:12.490347"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:23:12.492348"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 128ms (ActiveRecord: 28.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 5.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 24ms (Views: 21.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 6ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:23:12.726436"], ["current_sign_in_at", "2016-01-06 08:23:12.726436"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:23:12.727437"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 14ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:23:12.799464"], ["current_sign_in_at", "2016-01-06 08:23:12.799464"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:23:12.800464"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:23:12.837478"], ["current_sign_in_at", "2016-01-06 08:23:12.837478"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:23:12.838479"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (6.0ms)
Completed 200 OK in 7ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:23:12.861488"], ["updated_at", "2016-01-06 08:23:12.861488"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:23:12.891499"], ["current_sign_in_at", "2016-01-06 08:23:12.891499"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:23:12.892500"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:23:12.912508"], ["updated_at", "2016-01-06 08:23:12.912508"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:23:12 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:23:12.938516"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:23:12.940518"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:23:12.945519"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (11.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (3.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (15.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (8.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 08:37:13', '2016-01-06 08:37:13', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 08:37:13', '2016-01-06 08:37:13', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 08:37:13', '2016-01-06 08:37:13', 103210531)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 08:37:13', '2016-01-06 08:37:13', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 08:37:13', '2016-01-06 08:37:13', 83783397)[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (7.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$AmPUfRizmcG2GTI.WEo62.6RXvNCPkdtGRaXeqAWPtzI99kTBxMgu', '2016-01-06 08:37:13', '2016-01-06 08:37:13', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:37:13 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (182.2ms)
Completed 200 OK in 588ms (Views: 557.4ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:37:14.093705"], ["current_sign_in_at", "2016-01-06 08:37:14.093705"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:37:14.094705"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 28ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (30.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (41.0ms)
Completed 200 OK in 178ms (Views: 147.1ms | ActiveRecord: 30.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (11.0ms)
Completed 200 OK in 57ms (Views: 54.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:37:14.443946"], ["updated_at", "2016-01-06 08:37:14.443946"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 13ms (Views: 10.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (7.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:37:14.490964"], ["current_sign_in_at", "2016-01-06 08:37:14.490964"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:37:14.491965"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (6.0ms)
Completed 200 OK in 7ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (17.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 21ms (Views: 2.0ms | ActiveRecord: 19.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (40.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (44.0ms)
Completed 200 OK in 47ms (Views: 46.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:37:14.599013"], ["current_sign_in_at", "2016-01-06 08:37:14.599013"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:37:14.600014"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:37:14.662035"], ["current_sign_in_at", "2016-01-06 08:37:14.662035"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:37:14.663037"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:37:14.683044"], ["updated_at", "2016-01-06 08:37:14.683044"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:37:14.726060"], ["current_sign_in_at", "2016-01-06 08:37:14.726060"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:37:14.727060"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (7.0ms)
Completed 200 OK in 9ms (Views: 7.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:37:14.753072"], ["updated_at", "2016-01-06 08:37:14.753072"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:37:14.757072"], ["updated_at", "2016-01-06 08:37:14.757072"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:37:14.761075"], ["updated_at", "2016-01-06 08:37:14.761075"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:37:14.769077"], ["updated_at", "2016-01-06 08:37:14.769077"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:37:14.771078"], ["updated_at", "2016-01-06 08:37:14.771078"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:37:14.772079"], ["updated_at", "2016-01-06 08:37:14.772079"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:37:14.777080"], ["updated_at", "2016-01-06 08:37:14.777080"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:37:14.779081"], ["updated_at", "2016-01-06 08:37:14.779081"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:37:14.780081"], ["updated_at", "2016-01-06 08:37:14.780081"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:37:14.800089"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:37:14.802089"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:37:14.807093"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:37:14.831102"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 3ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:37:14.860112"], ["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 6ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 6ms (Views: 5.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:37:14 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (14.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (10.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (14.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 08:47:45', '2016-01-06 08:47:45', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 08:47:45', '2016-01-06 08:47:45', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 08:47:45', '2016-01-06 08:47:45', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 08:47:45', '2016-01-06 08:47:45', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 08:47:45', '2016-01-06 08:47:45', 83783397)[0m
  [1m[35mFixture Delete (14.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$jfJu2aAakzohdr58i/VF3.LRALir1knKs0wbebOP38EFxnENumuzq', '2016-01-06 08:47:46', '2016-01-06 08:47:46', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 15:47:46 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (3.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (76.0ms)
Completed 200 OK in 539ms (Views: 499.3ms | ActiveRecord: 3.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:47:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:47:46.716164"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 37ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:47:46 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 7ms (Views: 6.0ms | ActiveRecord: 1.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:47:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:47:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:47:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:47:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 6ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:47:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:47:46.825205"], ["id", 103210531]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:47:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:47:46.845212"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:47:46.847214"], ["id", 563589564]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:47:46.852215"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:47:46.865220"], ["updated_at", "2016-01-06 08:47:46.865220"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:47:46.870222"], ["updated_at", "2016-01-06 08:47:46.870222"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:47:46.873222"], ["updated_at", "2016-01-06 08:47:46.873222"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:47:46.888229"], ["updated_at", "2016-01-06 08:47:46.888229"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:47:46.889229"], ["updated_at", "2016-01-06 08:47:46.889229"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:47:46.891229"], ["updated_at", "2016-01-06 08:47:46.891229"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:47:46.894230"], ["updated_at", "2016-01-06 08:47:46.894230"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:47:46.896231"], ["updated_at", "2016-01-06 08:47:46.896231"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:47:46.897232"], ["updated_at", "2016-01-06 08:47:46.897232"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:47:46 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (139.1ms)
Completed 200 OK in 168ms (Views: 161.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:47:47.109392"], ["current_sign_in_at", "2016-01-06 08:47:47.109392"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:47:47.110392"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 28ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 27ms (Views: 22.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:47:47.206429"], ["updated_at", "2016-01-06 08:47:47.206429"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (34.1ms)
Completed 200 OK in 49ms (Views: 47.1ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:47:47.294520"], ["current_sign_in_at", "2016-01-06 08:47:47.294520"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:47:47.295521"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (44.0ms)
Completed 200 OK in 47ms (Views: 47.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:47:47.359543"], ["updated_at", "2016-01-06 08:47:47.359543"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:47:47.390556"], ["current_sign_in_at", "2016-01-06 08:47:47.390556"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:47:47.391556"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:47:47.426568"], ["current_sign_in_at", "2016-01-06 08:47:47.426568"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:47:47.427570"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:47:47.471586"], ["current_sign_in_at", "2016-01-06 08:47:47.471586"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:47:47.472587"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:47:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (11.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (5.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (12.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 08:57:26', '2016-01-06 08:57:26', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 08:57:26', '2016-01-06 08:57:26', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 08:57:26', '2016-01-06 08:57:26', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 08:57:26', '2016-01-06 08:57:26', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 08:57:26', '2016-01-06 08:57:26', 83783397)[0m
  [1m[35mFixture Delete (12.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (7.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$ua46EEtd9zR/qjeUP7g0N./7.ovBywq5iYsRsgpfBiGxt1BBvnvse', '2016-01-06 08:57:26', '2016-01-06 08:57:26', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:57:26 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:57:26.782873"], ["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 118ms (ActiveRecord: 3.0ms)
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:57:26 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:57:26.858901"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:57:26 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.1ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (11.0ms)
Completed 200 OK in 455ms (Views: 453.2ms | ActiveRecord: 1.1ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:57:27 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:57:27 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (6.0ms)
Completed 200 OK in 9ms (Views: 7.0ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:57:27 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:57:27 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 15:57:27 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:57:27 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:57:27.416247"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:57:27.418246"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:57:27.422248"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:57:27 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (298.7ms)
Completed 200 OK in 375ms (Views: 358.9ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:57:27 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (2.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:57:27.899212"], ["current_sign_in_at", "2016-01-06 08:57:27.899212"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:57:27.900212"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 27ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:57:27 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 41ms (Views: 40.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:57:27 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 22ms (Views: 19.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:57:28.011255"], ["updated_at", "2016-01-06 08:57:28.011255"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 6ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 14ms (Views: 11.0ms | ActiveRecord: 2.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:57:28.054270"], ["current_sign_in_at", "2016-01-06 08:57:28.054270"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:57:28.055272"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:57:28.092285"], ["current_sign_in_at", "2016-01-06 08:57:28.092285"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:57:28.093285"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:57:28.166312"], ["current_sign_in_at", "2016-01-06 08:57:28.166312"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:57:28.167313"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 8ms (Views: 3.0ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:57:28.232338"], ["current_sign_in_at", "2016-01-06 08:57:28.232338"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:57:28.233339"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:57:28.252346"], ["updated_at", "2016-01-06 08:57:28.252346"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:57:28 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:57:28.265351"], ["updated_at", "2016-01-06 08:57:28.265351"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:57:28.268352"], ["updated_at", "2016-01-06 08:57:28.268352"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:57:28.270353"], ["updated_at", "2016-01-06 08:57:28.270353"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:57:28.272353"], ["updated_at", "2016-01-06 08:57:28.272353"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:57:28.274354"], ["updated_at", "2016-01-06 08:57:28.274354"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:57:28.285362"], ["updated_at", "2016-01-06 08:57:28.285362"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:57:28.287358"], ["updated_at", "2016-01-06 08:57:28.287358"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:57:28.288360"], ["updated_at", "2016-01-06 08:57:28.288360"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:57:28.291360"], ["updated_at", "2016-01-06 08:57:28.291360"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (3.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (14.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 08:58:45', '2016-01-06 08:58:45', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 08:58:45', '2016-01-06 08:58:45', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 08:58:45', '2016-01-06 08:58:45', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 08:58:45', '2016-01-06 08:58:45', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 08:58:45', '2016-01-06 08:58:45', 83783397)[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$6UZM/wApCj35ul88PZxm3..NvjPb1qdbDbIUUKfuaOq8jAcdXAXa.', '2016-01-06 08:58:45', '2016-01-06 08:58:45', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:58:45 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (45.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 532ms (Views: 463.2ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (2.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:58:46.384940"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 34ms (ActiveRecord: 2.0ms)
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 7ms (Views: 6.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 08:58:46.423957"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 3ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:58:46.466971"], ["updated_at", "2016-01-06 08:58:46.466971"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:58:46.469973"], ["updated_at", "2016-01-06 08:58:46.469973"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:58:46.470974"], ["updated_at", "2016-01-06 08:58:46.470974"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (6.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:58:46.485006"], ["updated_at", "2016-01-06 08:58:46.485006"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:58:46.487008"], ["updated_at", "2016-01-06 08:58:46.487008"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:58:46.488009"], ["updated_at", "2016-01-06 08:58:46.488009"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:58:46.493010"], ["updated_at", "2016-01-06 08:58:46.493010"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:58:46.500012"], ["updated_at", "2016-01-06 08:58:46.500012"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:58:46.504013"], ["updated_at", "2016-01-06 08:58:46.504013"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-06 08:58:46.510016"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-06 08:58:46.511018"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 08:58:46.515018"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (91.1ms)
Completed 200 OK in 121ms (Views: 111.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (3.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 08:58:46.702129"], ["current_sign_in_at", "2016-01-06 08:58:46.702129"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:58:46.703130"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 25ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 16ms (Views: 13.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 15ms (Views: 13.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:58:46.816173"], ["current_sign_in_at", "2016-01-06 08:58:46.816173"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:58:46.817171"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 40ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (5.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 11ms (Views: 11.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:58:46.906206"], ["current_sign_in_at", "2016-01-06 08:58:46.906206"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:58:46.907206"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:58:46.952223"], ["current_sign_in_at", "2016-01-06 08:58:46.952223"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:58:46.954224"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:58:46.974233"], ["updated_at", "2016-01-06 08:58:46.974233"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 15:58:46 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 08:58:47.004244"], ["current_sign_in_at", "2016-01-06 08:58:47.004244"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 08:58:47.005245"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 15:58:47 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 15:58:47 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 15:58:47 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 08:58:47.023250"], ["updated_at", "2016-01-06 08:58:47.023250"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 15:58:47 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (14.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (3.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (11.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (8.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 09:00:58', '2016-01-06 09:00:58', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 09:00:58', '2016-01-06 09:00:58', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 09:00:58', '2016-01-06 09:00:58', 103210531)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 09:00:58', '2016-01-06 09:00:58', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 09:00:58', '2016-01-06 09:00:58', 83783397)[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (11.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$xwLjo.5eMKOGtB1Xibhl3uw6HjTUJa.NBqrJHD348R5t0Qug10xIu', '2016-01-06 09:00:58', '2016-01-06 09:00:58', 830138774)[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:00:59.012479"], ["updated_at", "2016-01-06 09:00:59.012479"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:00:59.018481"], ["updated_at", "2016-01-06 09:00:59.018481"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:00:59.020483"], ["updated_at", "2016-01-06 09:00:59.020483"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:00:59.023485"], ["updated_at", "2016-01-06 09:00:59.023485"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:00:59.031487"], ["updated_at", "2016-01-06 09:00:59.031487"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:00:59.067500"], ["updated_at", "2016-01-06 09:00:59.067500"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:00:59.069500"], ["updated_at", "2016-01-06 09:00:59.069500"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:00:59.070502"], ["updated_at", "2016-01-06 09:00:59.070502"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:00:59.075503"], ["updated_at", "2016-01-06 09:00:59.075503"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (11.0ms)
Completed 200 OK in 468ms (Views: 443.2ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 09:00:59.726775"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 5ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 09:00:59.749784"], ["id", 103210531]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 4ms (ActiveRecord: 2.0ms)
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (8.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (96.1ms)
Completed 200 OK in 125ms (Views: 117.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:00:59.943893"], ["current_sign_in_at", "2016-01-06 09:00:59.943893"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:00:59.944894"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 29ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:00:59 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 23ms (Views: 21.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:01:00.056935"], ["updated_at", "2016-01-06 09:01:00.056935"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 12ms (Views: 9.0ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:01:00.095951"], ["current_sign_in_at", "2016-01-06 09:01:00.095951"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:01:00.096951"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:01:00.115959"], ["updated_at", "2016-01-06 09:01:00.115959"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 3ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 09:01:00.156975"], ["current_sign_in_at", "2016-01-06 09:01:00.156975"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:01:00.157974"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 09:01:00.203991"], ["current_sign_in_at", "2016-01-06 09:01:00.203991"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:01:00.205992"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 11ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:01:00.534290"], ["current_sign_in_at", "2016-01-06 09:01:00.534290"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:01:00.535290"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:01:00 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-06 09:01:00.558297"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-06 09:01:00.560298"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 09:01:00.565300"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (9.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (10.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (11.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 09:13:32', '2016-01-06 09:13:32', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 09:13:32', '2016-01-06 09:13:32', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 09:13:32', '2016-01-06 09:13:32', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 09:13:32', '2016-01-06 09:13:32', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 09:13:32', '2016-01-06 09:13:32', 83783397)[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$MvLQk3PUKfYX5imYHUsvMuSg3E4H0M0W9e1GaJJAmRccfzqsGPR2m', '2016-01-06 09:13:32', '2016-01-06 09:13:32', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:13:32 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (43.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 494ms (Views: 426.3ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 21ms (Views: 5.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 6ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 09:13:33.220198"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 09:13:33.258213"], ["id", 83783397]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 5ms (ActiveRecord: 3.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:13:33.328307"], ["updated_at", "2016-01-06 09:13:33.328307"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:13:33.333309"], ["updated_at", "2016-01-06 09:13:33.333309"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (11.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:13:33.357318"], ["updated_at", "2016-01-06 09:13:33.357318"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:13:33.359320"], ["updated_at", "2016-01-06 09:13:33.359320"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:13:33.361319"], ["updated_at", "2016-01-06 09:13:33.361319"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:13:33.365321"], ["updated_at", "2016-01-06 09:13:33.365321"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:13:33.370323"], ["updated_at", "2016-01-06 09:13:33.370323"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:13:33.372323"], ["updated_at", "2016-01-06 09:13:33.372323"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:13:33.374332"], ["updated_at", "2016-01-06 09:13:33.374332"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 19ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (242.4ms)
Completed 200 OK in 308ms (Views: 299.4ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:13:33.810857"], ["current_sign_in_at", "2016-01-06 09:13:33.810857"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:13:33.811857"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 24ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 20ms (Views: 18.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:13:33.863876"], ["updated_at", "2016-01-06 09:13:33.863876"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 13ms (Views: 12.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:13:33.904892"], ["current_sign_in_at", "2016-01-06 09:13:33.904892"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:13:33.905893"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (42.0ms)
Completed 200 OK in 45ms (Views: 43.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:13:33 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 09:13:34.003966"], ["current_sign_in_at", "2016-01-06 09:13:34.003966"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:13:34.004967"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 09:13:34.048983"], ["current_sign_in_at", "2016-01-06 09:13:34.048983"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:13:34.049984"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 09:13:34.084998"], ["current_sign_in_at", "2016-01-06 09:13:34.084998"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:13:34.084998"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:13:34.104004"], ["updated_at", "2016-01-06 09:13:34.104004"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:13:34 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-06 09:13:34.118010"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-06 09:13:34.120010"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 09:13:34.124012"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (23.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (18.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (2.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (32.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (21.1ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 09:27:55', '2016-01-06 09:27:55', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 09:27:55', '2016-01-06 09:27:55', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 09:27:55', '2016-01-06 09:27:55', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 09:27:55', '2016-01-06 09:27:55', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 09:27:55', '2016-01-06 09:27:55', 83783397)[0m
  [1m[35mFixture Delete (24.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (13.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$8Rl0C57jpCgZcUqh0c9gy.ILryKTskZC5p1713oPAu6B8xSSDIHdG', '2016-01-06 09:27:55', '2016-01-06 09:27:55', 830138774)[0m
  [1m[35m (9.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:27:55.789721"], ["updated_at", "2016-01-06 09:27:55.789721"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:27:55.792722"], ["updated_at", "2016-01-06 09:27:55.792722"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:27:55.794723"], ["updated_at", "2016-01-06 09:27:55.794723"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:27:55.797729"], ["updated_at", "2016-01-06 09:27:55.797729"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:27:55.877755"], ["updated_at", "2016-01-06 09:27:55.877755"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:27:55.879756"], ["updated_at", "2016-01-06 09:27:55.879756"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:27:55.881756"], ["updated_at", "2016-01-06 09:27:55.881756"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (4.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:27:55.890759"], ["updated_at", "2016-01-06 09:27:55.890759"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:27:55.893760"], ["updated_at", "2016-01-06 09:27:55.893760"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (2.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 09:27:55.899763"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 09:27:55.909766"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:27:55 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (132.1ms)
Completed 200 OK in 587ms (Views: 559.3ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 09:27:56.614112"], ["current_sign_in_at", "2016-01-06 09:27:56.614112"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:27:56.615111"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 28ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 63ms (Views: 62.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 18ms (Views: 15.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 16ms (Views: 14.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:27:56.845198"], ["current_sign_in_at", "2016-01-06 09:27:56.845198"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:27:56.846199"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 38ms (Views: 38.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 6ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:27:56.919227"], ["current_sign_in_at", "2016-01-06 09:27:56.919227"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:27:56.920228"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:27:56.939235"], ["updated_at", "2016-01-06 09:27:56.939235"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:27:56.979250"], ["current_sign_in_at", "2016-01-06 09:27:56.979250"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:27:56.980250"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:27:56 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (10.0ms)
Completed 200 OK in 12ms (Views: 12.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:27:57.030269"], ["current_sign_in_at", "2016-01-06 09:27:57.030269"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:27:57.031270"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
Unpermitted parameter: total
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:27:57.051276"], ["updated_at", "2016-01-06 09:27:57.051276"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 3ms (ActiveRecord: 3.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 09:27:57.069284"], ["id", 459292723]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 2.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 09:27:57.145314"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:27:57 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (11.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (10.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (9.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (14.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 09:35:26', '2016-01-06 09:35:26', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 09:35:26', '2016-01-06 09:35:26', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 09:35:26', '2016-01-06 09:35:26', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 09:35:26', '2016-01-06 09:35:26', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 09:35:26', '2016-01-06 09:35:26', 83783397)[0m
  [1m[35mFixture Delete (13.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (10.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$WCnfbtGxsZnqzOIMWJtRiuRgHd5T8yky42FWmdUHfriq5dGm4IBjW', '2016-01-06 09:35:26', '2016-01-06 09:35:26', 830138774)[0m
  [1m[35m (6.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:35:26.860081"], ["updated_at", "2016-01-06 09:35:26.860081"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:35:26.865083"], ["updated_at", "2016-01-06 09:35:26.865083"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:35:26.916105"], ["updated_at", "2016-01-06 09:35:26.916105"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:35:26.918106"], ["updated_at", "2016-01-06 09:35:26.918106"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:35:26.919106"], ["updated_at", "2016-01-06 09:35:26.919106"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:35:26.923108"], ["updated_at", "2016-01-06 09:35:26.923108"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:35:26.956122"], ["updated_at", "2016-01-06 09:35:26.956122"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:35:26.958123"], ["updated_at", "2016-01-06 09:35:26.958123"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:35:26.960124"], ["updated_at", "2016-01-06 09:35:26.960124"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (2.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 09:35:26.967127"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 09:35:26.974130"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 20000], ["updated_at", "2016-01-06 09:35:26.977131"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:35:26 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (11.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 1089ms (Views: 1068.6ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 8ms (Views: 6.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 09:35:28.201782"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 4ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 09:35:28.220790"], ["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 459292723]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 103210531]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 917085421]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (6.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (94.0ms)
Completed 200 OK in 129ms (Views: 121.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 09:35:28.438882"], ["current_sign_in_at", "2016-01-06 09:35:28.438882"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:35:28.439882"], ["id", 830138774]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 66ms (ActiveRecord: 3.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 19ms (Views: 17.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:35:28.547928"], ["updated_at", "2016-01-06 09:35:28.547928"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 12ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:35:28.589946"], ["current_sign_in_at", "2016-01-06 09:35:28.589946"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:35:28.590946"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:35:28.609955"], ["updated_at", "2016-01-06 09:35:28.609955"]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:35:28.639967"], ["current_sign_in_at", "2016-01-06 09:35:28.639967"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:35:28.640968"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 10ms (Views: 9.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:35:28.676982"], ["current_sign_in_at", "2016-01-06 09:35:28.676982"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:35:28.677983"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:35:28.722001"], ["current_sign_in_at", "2016-01-06 09:35:28.722001"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:35:28.723002"], ["id", 830138774]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 2.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:35:28 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (13.1ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (15.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (16.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (198.2ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (68.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 09:36:40', '2016-01-06 09:36:40', 563589564)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 09:36:40', '2016-01-06 09:36:40', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 09:36:40', '2016-01-06 09:36:40', 103210531)[0m
  [1m[35mFixture Insert (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 09:36:40', '2016-01-06 09:36:40', 917085421)
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 09:36:40', '2016-01-06 09:36:40', 83783397)[0m
  [1m[35mFixture Delete (17.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (9.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$ClKCHkZpSdIs8PTDkd7ifOjJCmiK1Ca.KLeeOya40mxq3.6rhiIoe', '2016-01-06 09:36:40', '2016-01-06 09:36:40', 830138774)[0m
  [1m[35m (4.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:36:40 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (185.2ms)
Completed 200 OK in 629ms (Views: 603.5ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (2.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 09:36:41.649248"], ["current_sign_in_at", "2016-01-06 09:36:41.649248"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:36:41.650249"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 30ms (ActiveRecord: 4.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (3.1ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (11.0ms)
Completed 200 OK in 61ms (Views: 58.0ms | ActiveRecord: 3.1ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 19ms (Views: 17.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:36:41.807315"], ["updated_at", "2016-01-06 09:36:41.807315"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 9ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 13ms (Views: 11.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 09:36:41.860336"], ["current_sign_in_at", "2016-01-06 09:36:41.860336"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:36:41.861345"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:36:41.880346"], ["updated_at", "2016-01-06 09:36:41.880346"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 40ms (Views: 38.0ms | ActiveRecord: 2.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 8ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:36:41.952375"], ["current_sign_in_at", "2016-01-06 09:36:41.952375"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:36:41.953376"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (2.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (6.0ms)
Completed 200 OK in 9ms (Views: 7.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:36:41.990392"], ["current_sign_in_at", "2016-01-06 09:36:41.990392"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:36:41.991393"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:36:41 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:36:42.037411"], ["current_sign_in_at", "2016-01-06 09:36:42.037411"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:36:42.037411"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 3ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 10ms (Views: 10.0ms | ActiveRecord: 0.0ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 9ms (Views: 3.0ms | ActiveRecord: 2.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 09:36:42.127450"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 4ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 4ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:36:42 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 09:36:42.181473"], ["id", 83783397]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 4ms (ActiveRecord: 2.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 09:36:42.192478"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-06 09:36:42.194478"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 09:36:42.198480"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:36:42.205485"], ["updated_at", "2016-01-06 09:36:42.205485"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:36:42.207483"], ["updated_at", "2016-01-06 09:36:42.207483"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 459292723]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 103210531]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 917085421]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:36:42.217488"], ["updated_at", "2016-01-06 09:36:42.217488"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:36:42.219489"], ["updated_at", "2016-01-06 09:36:42.219489"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:36:42.221489"], ["updated_at", "2016-01-06 09:36:42.221489"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:36:42.226492"], ["updated_at", "2016-01-06 09:36:42.226492"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:36:42.227492"], ["updated_at", "2016-01-06 09:36:42.227492"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:36:42.229493"], ["updated_at", "2016-01-06 09:36:42.229493"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:36:42.234496"], ["updated_at", "2016-01-06 09:36:42.234496"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (18.0ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (9.0ms)[0m  ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "charities" DISABLE TRIGGER ALL
  [1m[36m (24.0ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (399.1ms)[0m  DELETE FROM "charities"
  [1m[36mFixture Insert (230.7ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Ban Khru Noi', 0, 'THB', '2016-01-06 09:38:03', '2016-01-06 09:38:03', 563589564)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Habitat for Humanity Thailand', 0, 'THB', '2016-01-06 09:38:03', '2016-01-06 09:38:03', 459292723)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Paper Ranger', 0, 'THB', '2016-01-06 09:38:03', '2016-01-06 09:38:03', 103210531)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Makhampom Theater', 0, 'THB', '2016-01-06 09:38:03', '2016-01-06 09:38:03', 917085421)
  [1m[36mFixture Insert (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at", "id") VALUES ('Thailand Association of the Blind', 0, 'THB', '2016-01-06 09:38:03', '2016-01-06 09:38:03', 83783397)[0m
  [1m[35mFixture Delete (19.0ms)[0m  DELETE FROM "users"
  [1m[36mFixture Insert (13.0ms)[0m  [1mINSERT INTO "users" ("email", "encrypted_password", "created_at", "updated_at", "id") VALUES ('john@omise.co', '$2a$04$oDz7QI/uJtvvE0I6P5fbNu8WibXqKsOBa3XOACSh80swUu5UUzcIO', '2016-01-06 09:38:04', '2016-01-06 09:38:04', 830138774)[0m
  [1m[35m (9.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "charities" ENABLE TRIGGER ALL[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_less_than_20_to_a_charity
---------------------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:38:04 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"19", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (3.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (15.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 568ms (Views: 499.2ms | ActiveRecord: 3.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_without_a_token
-----------------------------------------------------------
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:38:04 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :has_token rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
----------------------------------
WebsiteTest: test_should_get_index
----------------------------------
Started GET "/" for 127.0.0.1 at 2016-01-06 16:38:04 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 7ms (Views: 5.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_to_no_charity
---------------------------------------------------------
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:38:04 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"tokn_X", "charity"=>""}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Filter chain halted as :charity rendered or redirected
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------------------
WebsiteTest: test_that_if_the_charge_fail_from_omise_side_it_shows_an_error
---------------------------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:38:04 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"999", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (4.0ms)
Completed 200 OK in 12ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------
WebsiteTest: test_that_someone_can_donate_to_a_charity
------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:38:04 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 09:38:04.900581"], ["id", 563589564]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:38:04 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------
WebsiteTest: test_that_someone_can't_donate_0_to_a_charity
----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:38:04 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"0", "omise_token"=>"token_X", "charity"=>"563589564"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (2.0ms)
Filter chain halted as :amount rendered or redirected
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
-----------------------------------------------------------
WebsiteTest: test_that_we_can_donate_to_a_charity_at_random
-----------------------------------------------------------
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"[0m
Started POST "/donate" for 127.0.0.1 at 2016-01-06 16:38:04 +0700
Processing by WebsiteController#donate as HTML
  Parameters: {"amount"=>"100", "omise_token"=>"token_X", "charity"=>"random"}
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3[0m  [["total", 10000], ["updated_at", "2016-01-06 09:38:04.937597"], ["id", 83783397]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 5ms (ActiveRecord: 2.0ms)
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 459292723]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 103210531]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 917085421]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 83783397]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------
AppTest: test_that_we_can_build_a_charity
-----------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
AppTest: test_that_we_just_built_charity_has_a_total_of_0
---------------------------------------------------------
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-----------------------------------------------
AppTest: test_that_wen_can_find_a_charity_by_id
-----------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
AppTest: test_that_even_if_we_try_to_create_a_charity_with_more_than_0_THB_in_the_total_we_will_get_0_THB
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:38:04.956605"], ["updated_at", "2016-01-06 09:38:04.956605"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------
AppTest: test_that_we_cannot_create_a_charity_without_a_name
------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
---------------------------------------------------------------
AppTest: test_that_a_newly_created_charity_has_a_total_of_0_THB
---------------------------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:38:04.963607"], ["updated_at", "2016-01-06 09:38:04.963607"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
AppTest: test_that_all_charities_are_listed_by_creation_order
-------------------------------------------------------------
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:38:04.967609"], ["updated_at", "2016-01-06 09:38:04.967609"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:38:04.969611"], ["updated_at", "2016-01-06 09:38:04.969611"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 3"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:38:04.971611"], ["updated_at", "2016-01-06 09:38:04.971611"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------
AppTest: test_that_we_can_list_all_charities
--------------------------------------------
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------
AppTest: test_that_we_can_create_a_charity
------------------------------------------
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:38:04.976613"], ["updated_at", "2016-01-06 09:38:04.976613"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------
AppTest: test_that_we_can_count_all_charities
---------------------------------------------
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 459292723]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 103210531]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mDELETE FROM "charities" WHERE "charities"."id" = $1[0m  [["id", 917085421]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM "charities" WHERE "charities"."id" = $1  [["id", 83783397]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 0"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:38:04.985617"], ["updated_at", "2016-01-06 09:38:04.985617"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["name", "Anonymous Charity 1"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:38:04.986618"], ["updated_at", "2016-01-06 09:38:04.986618"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Anonymous Charity 2"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:38:04.988618"], ["updated_at", "2016-01-06 09:38:04.988618"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
CharityTest: test_that_we_can_credit_a_charity_some_money
---------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 09:38:04.992620"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
CharityTest: test_that_a_charity_total_balance_is_correct_even_if_credited_from_two_different_ruby_objects
----------------------------------------------------------------------------------------------------------
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1[0m  [["id", 563589564]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 10000], ["updated_at", "2016-01-06 09:38:04.997622"], ["id", 563589564]]
  [1m[36m (1.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "charities" SET "total" = $1, "updated_at" = $2 WHERE "charities"."id" = $3  [["total", 20000], ["updated_at", "2016-01-06 09:38:05.000623"], ["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities" WHERE "charities"."id" = $1 LIMIT 1  [["id", 563589564]]
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_create_a_new_charity
------------------------------------------------------------------------------
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (7.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (99.0ms)
Completed 200 OK in 129ms (Views: 121.1ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 09:38:05.173696"], ["current_sign_in_at", "2016-01-06 09:38:05.173696"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:38:05.174696"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 26ms (ActiveRecord: 4.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 21ms (Views: 17.0ms | ActiveRecord: 1.0ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "description"=>"A charity that helps elephants go back to the wild."}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "description", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["description", "A charity that helps elephants go back to the wild."], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:38:05.244726"], ["updated_at", "2016-01-06 09:38:05.244726"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 5ms (ActiveRecord: 2.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (4.0ms)
Completed 200 OK in 13ms (Views: 10.0ms | ActiveRecord: 1.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (1.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_and_set_the_total_amount
----------------------------------------------------------------------------------------------------------
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1[0m  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (9.0ms)
Completed 200 OK in 12ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["email", "john@omise.co"]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.0ms)[0m  UPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7  [["last_sign_in_at", "2016-01-06 09:38:05.290746"], ["current_sign_in_at", "2016-01-06 09:38:05.290746"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:38:05.291746"], ["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by WebsiteController#index as HTML
  [1m[35mCharity Load (1.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered website/index.html.erb within layouts/website (5.0ms)
Completed 200 OK in 7ms (Views: 6.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[35m (1.0ms)[0m  SELECT COUNT(*) FROM "charities"
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>"Elephant Nature Park", "total"=>"1000"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
Unpermitted parameter: total
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mINSERT INTO "charities" ("name", "total", "currency", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Elephant Nature Park"], ["total", 0], ["currency", "THB"], ["created_at", "2016-01-06 09:38:05.318758"], ["updated_at", "2016-01-06 09:38:05.318758"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/admin/charities
Completed 302 Found in 4ms (ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["id", 830138774]]
  [1m[35mCharity Load (0.0ms)[0m  SELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC
  Rendered admin/charities/index.html.erb within layouts/application (3.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35mCharity Load (0.0ms)[0m  SELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT  "charities".* FROM "charities"  ORDER BY "charities"."created_at" DESC LIMIT 1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_unauthenticated_user_cannot_reach_the_list_of_charities
------------------------------------------------------------------------------------------
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Admin::CharitiesController#index as HTML
Completed 401 Unauthorized in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_list_of_charities
-------------------------------------------------------------------------------------
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 10ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:38:05.407795"], ["current_sign_in_at", "2016-01-06 09:38:05.407795"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:38:05.408795"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 52ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 4.0ms | ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_cannot_create_a_new_charity_without_a_name
------------------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (4.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (8.0ms)
Completed 200 OK in 11ms (Views: 10.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:38:05.448813"], ["current_sign_in_at", "2016-01-06 09:38:05.448813"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:38:05.449814"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (0.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (1.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
Started POST "/admin/charities" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Admin::CharitiesController#create as HTML
  Parameters: {"charity"=>{"name"=>""}}
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "charities"[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Admin::CharitiesTest: test_that_an_authenticated_user_can_reach_the_new_charity_form
------------------------------------------------------------------------------------
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 830138774]]
Started GET "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.html.erb (3.0ms)
  Rendered devise/sessions/new.html.erb within layouts/application (7.0ms)
Completed 200 OK in 9ms (Views: 8.0ms | ActiveRecord: 0.0ms)
Started POST "/users/sign_in" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Devise::SessionsController#create as HTML
  Parameters: {"user"=>{"email"=>"john@omise.co", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.0ms)[0m  [1mSELECT  "users".* FROM "users" WHERE "users"."email" = $1  ORDER BY "users"."id" ASC LIMIT 1[0m  [["email", "john@omise.co"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mUPDATE "users" SET "last_sign_in_at" = $1, "current_sign_in_at" = $2, "last_sign_in_ip" = $3, "current_sign_in_ip" = $4, "sign_in_count" = $5, "updated_at" = $6 WHERE "users"."id" = $7[0m  [["last_sign_in_at", "2016-01-06 09:38:05.494833"], ["current_sign_in_at", "2016-01-06 09:38:05.494833"], ["last_sign_in_ip", "127.0.0.1/32"], ["current_sign_in_ip", "127.0.0.1/32"], ["sign_in_count", 1], ["updated_at", "2016-01-06 09:38:05.495833"], ["id", 830138774]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.0ms)
Started GET "/" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by WebsiteController#index as HTML
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered website/index.html.erb within layouts/website (2.0ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Admin::CharitiesController#index as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  [1m[36mCharity Load (1.0ms)[0m  [1mSELECT "charities".* FROM "charities"  ORDER BY "charities"."created_at" ASC[0m
  Rendered admin/charities/index.html.erb within layouts/application (2.0ms)
Completed 200 OK in 5ms (Views: 2.0ms | ActiveRecord: 1.0ms)
Started GET "/admin/charities/new" for 127.0.0.1 at 2016-01-06 16:38:05 +0700
Processing by Admin::CharitiesController#new as HTML
  [1m[35mUser Load (0.0ms)[0m  SELECT  "users".* FROM "users" WHERE "users"."id" = $1  ORDER BY "users"."id" ASC LIMIT 1  [["id", 830138774]]
  Rendered admin/charities/new.html.erb within layouts/application (1.0ms)
Completed 200 OK in 5ms (Views: 3.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
